`stackalloc` –≤ C# ‚Äî —ç—Ç–æ –∫–ª—é—á–µ–≤–æ–µ —Å–ª–æ–≤–æ, –∫–æ—Ç–æ—Ä–æ–µ –ø–æ–∑–≤–æ–ª—è–µ—Ç **–≤—ã–¥–µ–ª—è—Ç—å –ø–∞–º—è—Ç—å –Ω–∞ —Å—Ç–µ–∫–µ** –¥–ª—è –º–∞—Å—Å–∏–≤–∞ –∑–Ω–∞—á–∏–º—ã—Ö —Ç–∏–ø–æ–≤. –û–Ω–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –ø–æ–≤—ã—à–µ–Ω–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏, –æ—Å–æ–±–µ–Ω–Ω–æ –∫–æ–≥–¥–∞ –Ω—É–∂–Ω–æ –≤—Ä–µ–º–µ–Ω–Ω–æ –≤—ã–¥–µ–ª–∏—Ç—å –Ω–µ–±–æ–ª—å—à–æ–π –±—É—Ñ–µ—Ä, –Ω–µ –Ω–∞–≥—Ä—É–∂–∞—è –∫—É—á—É (heap).

---

## üîπ –ß—Ç–æ –¥–µ–ª–∞–µ—Ç `stackalloc`?

- –í—ã–¥–µ–ª—è–µ—Ç **–Ω–µ—É–ø—Ä–∞–≤–ª—è–µ–º—É—é** –ø–∞–º—è—Ç—å **–Ω–∞ —Å—Ç–µ–∫–µ**, –∞ –Ω–µ –≤ –∫—É—á–µ.
    
- –û—á–µ–Ω—å –±—ã—Å—Ç—Ä–æ, —Ç.–∫. —Å—Ç–µ–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç –ø–æ –ø—Ä–∏–Ω—Ü–∏–ø—É LIFO –∏ –Ω–µ —Ç—Ä–µ–±—É–µ—Ç —Å–±–æ—Ä–∫–∏ –º—É—Å–æ—Ä–∞.
    
- –ü–æ–¥—Ö–æ–¥–∏—Ç —Ç–æ–ª—å–∫–æ –¥–ª—è **–∑–Ω–∞—á–∏–º—ã—Ö —Ç–∏–ø–æ–≤** (struct).
    
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Å `Span<T>` –∏–ª–∏ —É–∫–∞–∑–∞—Ç–µ–ª—è–º–∏.
    

---

## ‚úÖ –ü—Ä–∏–º–µ—Ä 1 ‚Äî —Å `Span<T>`

```csharp
Span<int> buffer = stackalloc int[5];

for (int i = 0; i < buffer.Length; i++)
{
    buffer[i] = i * 10;
}

foreach (var item in buffer)
    Console.WriteLine(item);
```

üî∏ –ó–¥–µ—Å—å `buffer` ‚Äî —ç—Ç–æ –º–∞—Å—Å–∏–≤ –Ω–∞ —Å—Ç–µ–∫–µ. –û–Ω **–∏—Å—á–µ–∑–Ω–µ—Ç** —Å—Ä–∞–∑—É –ø–æ—Å–ª–µ –≤—ã—Ö–æ–¥–∞ –∏–∑ –æ–±–ª–∞—Å—Ç–∏ –≤–∏–¥–∏–º–æ—Å—Ç–∏.

---

## ‚úÖ –ü—Ä–∏–º–µ—Ä 2 ‚Äî –±–µ–∑ `Span<T>` (unsafe context):

```csharp
unsafe
{
    int* ptr = stackalloc int[3];
    ptr[0] = 1;
    ptr[1] = 2;
    ptr[2] = 3;

    Console.WriteLine(ptr[1]); // –≤—ã–≤–µ–¥–µ—Ç 2
}
```

üìå –≠—Ç–æ—Ç —Å–ø–æ—Å–æ–± —Ç—Ä–µ–±—É–µ—Ç –∫–ª—é—á–µ–≤–æ–≥–æ —Å–ª–æ–≤–∞ `unsafe` –∏ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö –ø—Ä–æ–µ–∫—Ç–∞.

---

## üîê –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è

|–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ|–û–ø–∏—Å–∞–Ω–∏–µ|
|---|---|
|–¢–æ–ª—å–∫–æ **–∑–Ω–∞—á–∏–º—ã–µ —Ç–∏–ø—ã**|`stackalloc` –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –∫–ª–∞—Å—Å—ã|
|–¢–æ–ª—å–∫–æ –≤ **–º–µ—Ç–æ–¥–∞—Ö**|–ù–µ–ª—å–∑—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –Ω–∞ —É—Ä–æ–≤–Ω–µ –∫–ª–∞—Å—Å–∞|
|–†–∞–∑–º–µ—Ä –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –∏–∑–≤–µ—Å—Ç–µ–Ω –Ω–∞ –º–æ–º–µ–Ω—Ç –∫–æ–º–ø–∏–ª—è—Ü–∏–∏ (–∏–ª–∏ –±—ã—Ç—å –∑–Ω–∞—á–µ–Ω–∏–µ–º `const`/`readonly`)||
|–ù–µ –≤—ã—Ö–æ–¥–∏—Ç –∑–∞ –ø—Ä–µ–¥–µ–ª—ã –æ–±–ª–∞—Å—Ç–∏|–ù–µ–ª—å–∑—è –≤–µ—Ä–Ω—É—Ç—å `stackalloc` –º–∞—Å—Å–∏–≤ –∏–∑ –º–µ—Ç–æ–¥–∞|

---

## üü° –ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å?

- –í **–≤—ã—Å–æ–∫–æ–ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ–º** –∫–æ–¥–µ
    
- –î–ª—è **–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö** –±—É—Ñ–µ—Ä–æ–≤ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Å—Ç—Ä–æ–∫, —á–∏—Å–µ–ª)
    
- –ö–æ–≥–¥–∞ —Ä–∞–±–æ—Ç–∞ —Å –∫—É—á–µ–π –Ω–µ–¥–æ–ø—É—Å—Ç–∏–º–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –≤–Ω—É—Ç—Ä–∏ hot-path –º–µ—Ç–æ–¥–∞)
    

---

–•–æ—á–µ—à—å ‚Äî –º–æ–≥—É –ø–æ–∫–∞–∑–∞—Ç—å, –∫–∞–∫ `stackalloc` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ `TryParse`, –Ω–∞–ø—Ä–∏–º–µ—Ä `int.TryParse` –≤ .NET.