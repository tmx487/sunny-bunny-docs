–û—Ç–∑—ã–≤ (—Ä–µ–≤–æ–∫–∞—Ü–∏—è) —Ç–æ–∫–µ–Ω–∞ ‚Äî —ç—Ç–æ –ø—Ä–æ—Ü–µ—Å—Å –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ–≥–æ –∞–Ω–Ω—É–ª–∏—Ä–æ–≤–∞–Ω–∏—è access –∏–ª–∏ refresh —Ç–æ–∫–µ–Ω–∞ –¥–æ –µ–≥–æ –µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ –∏—Å—Ç–µ—á–µ–Ω–∏—è. –≠—Ç–æ—Ç –º–µ—Ö–∞–Ω–∏–∑–º –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –ø–æ–≤—ã—à–µ–Ω–∏—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏, –Ω–∞–ø—Ä–∏–º–µ—Ä, –∫–æ–≥–¥–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤—ã—Ö–æ–¥–∏—Ç –∏–∑ —Å–∏—Å—Ç–µ–º—ã –∏–ª–∏ –∫–æ–≥–¥–∞ –µ—Å—Ç—å –ø–æ–¥–æ–∑—Ä–µ–Ω–∏–µ –Ω–∞ –∫–æ–º–ø—Ä–æ–º–µ—Ç–∞—Ü–∏—é —É—á–µ—Ç–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö.

### üîπ **–ü—Ä–æ—Ü–µ—Å—Å –æ—Ç–∑—ã–≤–∞ —Ç–æ–∫–µ–Ω–∞**

#### 1Ô∏è‚É£ –ò–Ω–∏—Ü–∏–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—Ç–∑—ã–≤–∞

- –ö–ª–∏–µ–Ω—Ç (–Ω–∞–ø—Ä–∏–º–µ—Ä, –≤–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∏–ª–∏ –º–æ–±–∏–ª—å–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ) –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –∑–∞–ø—Ä–æ—Å –Ω–∞ —Å–µ—Ä–≤–µ—Ä –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ —Å –ø—Ä–æ—Å—å–±–æ–π –∞–Ω–Ω—É–ª–∏—Ä–æ–≤–∞—Ç—å access –∏–ª–∏ refresh —Ç–æ–∫–µ–Ω.
- –û–±—ã—á–Ω–æ —ç—Ç–æ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è —á–µ—Ä–µ–∑ —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–π **endpoint –¥–ª—è –æ—Ç–∑—ã–≤–∞ —Ç–æ–∫–µ–Ω–æ–≤** (`/revoke`).

#### 2Ô∏è‚É£ –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤–∞–ª–∏–¥–Ω–æ—Å—Ç–∏ —Ç–æ–∫–µ–Ω–∞

- –°–µ—Ä–≤–µ—Ä –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –ø–µ—Ä–µ–¥–∞–Ω–Ω—ã–π —Ç–æ–∫–µ–Ω (–µ–≥–æ –ø–æ–¥–ø–∏—Å—å, —Å—Ä–æ–∫ –¥–µ–π—Å—Ç–≤–∏—è, –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–Ω–æ—Å—Ç—å –∫–ª–∏–µ–Ω—Ç—É –∏ —Ç. –¥.).
- –ï—Å–ª–∏ —Ç–æ–∫–µ–Ω –∫–æ—Ä—Ä–µ–∫—Ç–µ–Ω, –ø—Ä–æ—Ü–µ—Å—Å –ø—Ä–æ–¥–æ–ª–∂–∞–µ—Ç—Å—è.

#### 3Ô∏è‚É£ –ê–Ω–Ω—É–ª–∏—Ä–æ–≤–∞–Ω–∏–µ —Ç–æ–∫–µ–Ω–∞

–í –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ç–∏–ø–∞ —Ç–æ–∫–µ–Ω–∞ –ø—Ä–æ—Ü–µ—Å—Å –æ—Ç–∑—ã–≤–∞ —Ä–∞–∑–ª–∏—á–∞–µ—Ç—Å—è:

‚úÖ **–û—Ç–∑—ã–≤ refresh —Ç–æ–∫–µ–Ω–∞:**

- Refresh —Ç–æ–∫–µ–Ω **—É–¥–∞–ª—è–µ—Ç—Å—è** –∏–∑ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö (–µ—Å–ª–∏ —Ö—Ä–∞–Ω–∏–ª—Å—è –≤ –ë–î) –∏–ª–∏ –ø–æ–º–µ—á–∞–µ—Ç—Å—è –∫–∞–∫ –æ—Ç–æ–∑–≤–∞–Ω–Ω—ã–π.
- –í—Å–µ access —Ç–æ–∫–µ–Ω—ã, –≤—ã–¥–∞–Ω–Ω—ã–µ —Å —ç—Ç–∏–º refresh —Ç–æ–∫–µ–Ω–æ–º, —Ç–æ–∂–µ —Å—Ç–∞–Ω–æ–≤—è—Ç—Å—è –Ω–µ–¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã–º–∏.
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤—ã–Ω—É–∂–¥–µ–Ω –∑–∞–Ω–æ–≤–æ –ø—Ä–æ–π—Ç–∏ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—é.

‚úÖ **–û—Ç–∑—ã–≤ access —Ç–æ–∫–µ–Ω–∞:**

- Access —Ç–æ–∫–µ–Ω **–æ–±—ã—á–Ω–æ –Ω–µ —Ö—Ä–∞–Ω–∏—Ç—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ**, —Ç–∞–∫ –∫–∞–∫ –æ–Ω —Å–∞–º–æ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω—ã–π (JWT).
- –í–æ–∑–º–æ–∂–Ω—ã–µ –≤–∞—Ä–∏–∞–Ω—Ç—ã –∞–Ω–Ω—É–ª–∏—Ä–æ–≤–∞–Ω–∏—è:
    - –î–æ–±–∞–≤–∏—Ç—å —Ç–æ–∫–µ–Ω –≤ **—á–µ—Ä–Ω—ã–π —Å–ø–∏—Å–æ–∫** (Blacklist) –∏ –ø—Ä–æ–≤–µ—Ä—è—Ç—å –µ–≥–æ –Ω–∞ –∫–∞–∂–¥–æ–º –∑–∞–ø—Ä–æ—Å–µ.
    - –ò–∑–º–µ–Ω–∏—Ç—å –∫–ª—é—á –ø–æ–¥–ø–∏—Å–∏ (Signing Key), —á—Ç–æ –∞–Ω–Ω—É–ª–∏—Ä—É–µ—Ç –≤—Å–µ –∞–∫—Ç–∏–≤–Ω—ã–µ —Ç–æ–∫–µ–Ω—ã.

#### 4Ô∏è‚É£ –û—Ç–≤–µ—Ç —Å–µ—Ä–≤–µ—Ä—É

- –ï—Å–ª–∏ –æ—Ç–∑—ã–≤ –ø—Ä–æ—à–µ–ª —É—Å–ø–µ—à–Ω–æ, —Å–µ—Ä–≤–µ—Ä –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç **HTTP 200 OK**.
- –ï—Å–ª–∏ —Ç–æ–∫–µ–Ω —É–∂–µ –æ—Ç–æ–∑–≤–∞–Ω –∏–ª–∏ –Ω–µ–≤–∞–ª–∏–¥–µ–Ω, –≤–æ–∑–º–æ–∂–µ–Ω –æ—Ç–≤–µ—Ç **400 Bad Request** –∏–ª–∏ **401 Unauthorized**.

---

### üîπ **–ü—Ä–∏–º–µ—Ä –∑–∞–ø—Ä–æ—Å–∞ –Ω–∞ –æ—Ç–∑—ã–≤ refresh —Ç–æ–∫–µ–Ω–∞**

```http
POST /revoke
Content-Type: application/json
Authorization: Bearer {access_token}

{
    "token": "{refresh_token}"
}
```

### üîπ **–ü—Ä–∏–º–µ—Ä –æ–±—Ä–∞–±–æ—Ç–∫–∏ –æ—Ç–∑—ã–≤–∞ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ (.NET 8, IdentityServer)**

```csharp
[HttpPost("revoke")]
public async Task<IActionResult> RevokeToken([FromBody] RevokeTokenRequest request)
{
    var userId = User.FindFirst(ClaimTypes.NameIdentifier)?.Value;
    if (userId == null)
        return Unauthorized();

    var result = await _tokenService.RevokeRefreshTokenAsync(userId, request.Token);
    return result ? Ok() : BadRequest("Invalid token");
}
```

---

### üîπ **–ö–æ–≥–¥–∞ —Å—Ç–æ–∏—Ç –æ—Ç–∑—ã–≤–∞—Ç—å —Ç–æ–∫–µ–Ω—ã?**

‚úî –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤—ã—à–µ–ª –∏–∑ —Å–∏—Å—Ç–µ–º—ã (`Logout`).  
‚úî –ò–∑–º–µ–Ω–µ–Ω –ø–∞—Ä–æ–ª—å –∏–ª–∏ email –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.  
‚úî –í—ã—è–≤–ª–µ–Ω–∞ –∫–æ–º–ø—Ä–æ–º–µ—Ç–∞—Ü–∏—è —É—á–µ—Ç–Ω–æ–π –∑–∞–ø–∏—Å–∏.  
‚úî –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä –≤—Ä—É—á–Ω—É—é –æ—Ç–∑—ã–≤–∞–µ—Ç –¥–æ—Å—Ç—É–ø.

üîπ **–í—ã–≤–æ–¥**: Access —Ç–æ–∫–µ–Ω—ã –æ–±—ã—á–Ω–æ –Ω–µ —Ö—Ä–∞–Ω—è—Ç—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ, –ø–æ—ç—Ç–æ–º—É –∏—Ö –æ—Ç–æ–∑–≤–∞—Ç—å —Å–ª–æ–∂–Ω–æ (–µ—Å–ª–∏ —Ç–æ–ª—å–∫–æ —á–µ—Ä–µ–∑ blacklist –∏–ª–∏ —Å–º–µ–Ω—É –∫–ª—é—á–∞ –ø–æ–¥–ø–∏—Å–∏). Refresh —Ç–æ–∫–µ–Ω—ã —Ö—Ä–∞–Ω—è—Ç—Å—è –∏ –º–æ–≥—É—Ç –±—ã—Ç—å –∞–Ω–Ω—É–ª–∏—Ä–æ–≤–∞–Ω—ã —Å–µ—Ä–≤–µ—Ä–æ–º.

## –ú–æ–∂–Ω–æ –ª–∏ –æ—Ç–æ–∑–≤–∞—Ç—å —Å—Ä–∞–∑—É –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ç–æ–∫–µ–Ω–æ–≤?

–î–∞, –º–æ–∂–Ω–æ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ –æ—Ç–∑—ã–≤–∞—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ç–æ–∫–µ–Ω–æ–≤. –ï—Å–ª–∏ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä –≤—ã–±—Ä–∞–ª –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤ –≤ —Å–ø–∏—Å–∫–µ –∏ –Ω–∞–∂–∞–ª "–û—Ç–æ–∑–≤–∞—Ç—å —Ç–æ–∫–µ–Ω", —Å–µ—Ä–≤–µ—Ä –¥–æ–ª–∂–µ–Ω –æ–±—Ä–∞–±–æ—Ç–∞—Ç—å –æ—Ç–∑—ã–≤ –≤—Å–µ—Ö —Å–≤—è–∑–∞–Ω–Ω—ã—Ö —Ç–æ–∫–µ–Ω–æ–≤.

### üîπ **–ö–∞–∫ —ç—Ç–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å?**

#### 1Ô∏è‚É£ **–•—Ä–∞–Ω–µ–Ω–∏–µ Refresh-—Ç–æ–∫–µ–Ω–æ–≤ –≤ –±–∞–∑–µ**

–î–ª—è —Ç–æ–≥–æ —á—Ç–æ–±—ã –º–æ–∂–Ω–æ –±—ã–ª–æ –æ—Ç–æ–∑–≤–∞—Ç—å —Ç–æ–∫–µ–Ω—ã —É –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, –Ω—É–∂–Ω–æ —Ö—Ä–∞–Ω–∏—Ç—å refresh-—Ç–æ–∫–µ–Ω—ã –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö. –≠—Ç–æ –º–æ–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å, –Ω–∞–ø—Ä–∏–º–µ—Ä, –≤ —Ç–∞–±–ª–∏—Ü–µ `RefreshTokens`:

```sql
CREATE TABLE RefreshTokens (
    Id SERIAL PRIMARY KEY,
    UserId UUID NOT NULL,
    Token TEXT NOT NULL,
    ExpiryDate TIMESTAMP NOT NULL,
    IsRevoked BOOLEAN DEFAULT FALSE
);
```

#### 2Ô∏è‚É£ **–ó–∞–ø—Ä–æ—Å –æ—Ç –∫–ª–∏–µ–Ω—Ç–∞**

–ö–æ–≥–¥–∞ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä –≤—ã–±–∏—Ä–∞–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏ –Ω–∞–∂–∏–º–∞–µ—Ç –∫–Ω–æ–ø–∫—É "–û—Ç–æ–∑–≤–∞—Ç—å", —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –º–∞—Å—Å–∏–≤ `userIds` –Ω–∞ —Å–µ—Ä–≤–µ—Ä:

```http
POST /revoke-multiple
Content-Type: application/json
Authorization: Bearer {admin_access_token}

{
    "userIds": ["user-1-guid", "user-2-guid", "user-3-guid"]
}
```

#### 3Ô∏è‚É£ **–û–±—Ä–∞–±–æ—Ç–∫–∞ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ (.NET 8, Entity Framework, Identity)**

```csharp
[HttpPost("revoke-multiple")]
[Authorize(Roles = "Admin")]
public async Task<IActionResult> RevokeMultipleTokens([FromBody] RevokeMultipleRequest request)
{
    if (request.UserIds == null || request.UserIds.Count == 0)
        return BadRequest("User IDs are required");

    var tokens = await _context.RefreshTokens
        .Where(t => request.UserIds.Contains(t.UserId) && !t.IsRevoked)
        .ToListAsync();

    if (tokens.Count == 0)
        return NotFound("No active tokens found for given users");

    foreach (var token in tokens)
    {
        token.IsRevoked = true;
    }

    await _context.SaveChangesAsync();
    return Ok("Tokens revoked successfully");
}
```

#### 4Ô∏è‚É£ **–ß—Ç–æ –¥–∞–ª—å—à–µ?**

–ü–æ—Å–ª–µ –æ—Ç–∑—ã–≤–∞ refresh-—Ç–æ–∫–µ–Ω–æ–≤: ‚úÖ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –±–æ–ª—å—à–µ –Ω–µ —Å–º–æ–≥—É—Ç –æ–±–Ω–æ–≤–∏—Ç—å access-—Ç–æ–∫–µ–Ω –∏ –±—É–¥—É—Ç –≤—ã–Ω—É–∂–¥–µ–Ω—ã –∑–∞–Ω–æ–≤–æ –≤–æ–π—Ç–∏.  
‚úÖ Access-—Ç–æ–∫–µ–Ω—ã –ø—Ä–æ–¥–æ–ª–∂–∞—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –¥–æ –∏—Å—Ç–µ—á–µ–Ω–∏—è —Å—Ä–æ–∫–∞ –¥–µ–π—Å—Ç–≤–∏—è, **–µ—Å–ª–∏ –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è blacklist**.

#### 5Ô∏è‚É£ **–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ: –º–æ–º–µ–Ω—Ç–∞–ª—å–Ω—ã–π –≤—ã—Ö–æ–¥ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π**

–ï—Å–ª–∏ –Ω—É–∂–Ω–æ **–Ω–µ–º–µ–¥–ª–µ–Ω–Ω–æ** —Ä–∞–∑–ª–æ–≥–∏–Ω–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π:

- –ú–æ–∂–Ω–æ —Ö—Ä–∞–Ω–∏—Ç—å **—á–µ—Ä–Ω—ã–π —Å–ø–∏—Å–æ–∫ access-—Ç–æ–∫–µ–Ω–æ–≤** –≤ Redis.
- –ò–ª–∏ –∏–∑–º–µ–Ω–∏—Ç—å signing key (—á—Ç–æ —Å–¥–µ–ª–∞–µ—Ç –≤—Å–µ —Ç–æ–∫–µ–Ω—ã –Ω–µ–¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã–º–∏).

üîπ **–í—ã–≤–æ–¥:** –î–∞, –º–æ–∂–Ω–æ –æ—Ç–∑—ã–≤–∞—Ç—å —Ç–æ–∫–µ–Ω—ã —É –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —Å—Ä–∞–∑—É. –°–∞–º—ã–π –ø—Ä–æ—Å—Ç–æ–π –≤–∞—Ä–∏–∞–Ω—Ç ‚Äî —É–¥–∞–ª—è—Ç—å –∏–ª–∏ –ø–æ–º–µ—á–∞—Ç—å refresh-—Ç–æ–∫–µ–Ω—ã –∫–∞–∫ –æ—Ç–æ–∑–≤–∞–Ω–Ω—ã–µ –≤ –ë–î.

## –ß—Ç–æ –¥–µ–ª–∞—Ç—å –µ—Å–ª–∏ —Ç–æ–∫–µ–Ω—ã –º–æ–≥—É—Ç –æ—Ç–∑—ã–≤–∞—Ç—å 2 –∏ –±–æ–ª–µ–µ —Ä–æ–ª–µ–π?

–ï—Å–ª–∏ –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ä–æ–ª–µ–π –º–æ–≥—É—Ç –æ—Ç–∑—ã–≤–∞—Ç—å —Ç–æ–∫–µ–Ω—ã, —Ç–æ –ø—Ä–∞–≤–∏–ª—å–Ω–µ–µ –≤—Å–µ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å **–∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–æ–Ω–Ω—ã–µ –ø–æ–ª–∏—Ç–∏–∫–∏**. –í –¥–∞–Ω–Ω–æ–º —Å–ª—É—á–∞–µ —É –≤–∞—Å —É–∂–µ –µ—Å—Ç—å –ø–æ–ª–∏—Ç–∏–∫–∏ –¥–ª—è —Ä–∞–∑–Ω—ã—Ö —Ä–æ–ª–µ–π, –ø–æ—ç—Ç–æ–º—É –º–æ–∂–Ω–æ —Å–æ–∑–¥–∞—Ç—å **–æ–±—â—É—é –ø–æ–ª–∏—Ç–∏–∫—É** –∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –µ—ë –≤ `Authorize`.

---

### üîπ **–°–ø–æ—Å–æ–±—ã —Ä–µ—à–µ–Ω–∏—è**

#### ‚úÖ **1. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ä–æ–ª–µ–π –≤ `[Authorize]` (–µ—Å–ª–∏ –ø—Ä–æ–≤–µ—Ä–∫–∞ —Ç–æ–ª—å–∫–æ –ø–æ —Ä–æ–ª—è–º)**

–í—ã –º–æ–∂–µ—Ç–µ –ø–µ—Ä–µ–¥–∞—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ä–æ–ª–µ–π —á–µ—Ä–µ–∑ –∑–∞–ø—è—Ç—É—é:

```csharp
[Authorize(Roles = "Owner,Teacher")]
```

üîπ **–ú–∏–Ω—É—Å**: –≠—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç —Ç–æ–ª—å–∫–æ –¥–ª—è `[Authorize(Roles = "...")]`, –Ω–æ –Ω–µ —Å –∫–∞—Å—Ç–æ–º–Ω—ã–º–∏ –ø–æ–ª–∏—Ç–∏–∫–∞–º–∏.

---

#### ‚úÖ **2. –°–æ–∑–¥–∞—Ç—å –µ–¥–∏–Ω—É—é –ø–æ–ª–∏—Ç–∏–∫—É –¥–ª—è –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö —Ä–æ–ª–µ–π (–ª—É—á—à–∏–π –≤–∞—Ä–∏–∞–Ω—Ç)**

–í `Program.cs` (–∏–ª–∏ `Startup.cs`, –µ—Å–ª–∏ —Å—Ç–∞—Ä—ã–π —Å—Ç–∏–ª—å) –¥–æ–±–∞–≤—å—Ç–µ –Ω–æ–≤—É—é –ø–æ–ª–∏—Ç–∏–∫—É:

```csharp
.AddAuthorization(options =>
{
    options.AddPolicy("CanRevokeTokens", policy =>
        policy.RequireRole(RolesContants.Owner, RolesContants.Teacher));
});
```

–¢–µ–ø–µ—Ä—å –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ —ç—Ç—É –ø–æ–ª–∏—Ç–∏–∫—É –≤ `Authorize`:

```csharp
[Authorize(Policy = "CanRevokeTokens")]
[HttpPost("revoke-multiple")]
public async Task<IActionResult> RevokeMultipleTokens([FromBody] RevokeMultipleRequest request)
{
    // –õ–æ–≥–∏–∫–∞ –æ—Ç–∑—ã–≤–∞ —Ç–æ–∫–µ–Ω–æ–≤
}
```

üîπ **–ü–ª—é—Å—ã:**  
‚úÖ –ì–∏–±–∫–æ—Å—Ç—å: –º–æ–∂–Ω–æ –ª–µ–≥–∫–æ –¥–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—ã–µ —Ä–æ–ª–∏.  
‚úÖ –ü–æ–¥–¥–µ—Ä–∂–∫–∞ **–∫–∞—Å—Ç–æ–º–Ω–æ–π –ª–æ–≥–∏–∫–∏** (–º–æ–∂–Ω–æ –¥–æ–±–∞–≤–ª—è—Ç—å –¥—Ä—É–≥–∏–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è, –∞ –Ω–µ —Ç–æ–ª—å–∫–æ `RequireRole`).

---

#### ‚úÖ **3. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ `[Authorize]` (–∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–π –≤–∞—Ä–∏–∞–Ω—Ç)**

–í—ã —Ç–∞–∫–∂–µ –º–æ–∂–µ—Ç–µ –¥–æ–±–∞–≤–∏—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ `[Authorize]`, –Ω–æ —ç—Ç–æ –Ω–µ —Å–∞–º—ã–π —ç–ª–µ–≥–∞–Ω—Ç–Ω—ã–π –≤–∞—Ä–∏–∞–Ω—Ç:

```csharp
[Authorize(Policy = "Owner")]
[Authorize(Policy = "Teacher")]
[HttpPost("revoke-multiple")]
public async Task<IActionResult> RevokeMultipleTokens([FromBody] RevokeMultipleRequest request)
{
    // –õ–æ–≥–∏–∫–∞ –æ—Ç–∑—ã–≤–∞ —Ç–æ–∫–µ–Ω–æ–≤
}
```

üîπ **–ú–∏–Ω—É—Å—ã:**  
‚ùå –ß—É—Ç—å —Å–ª–æ–∂–Ω–µ–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—Ç—å, –µ—Å–ª–∏ —Ä–æ–ª–µ–π –±—É–¥–µ—Ç –±–æ–ª—å—à–µ.

---

### üîπ **–í—ã–≤–æ–¥**

–õ—É—á—à–∏–π –≤–∞—Ä–∏–∞–Ω—Ç ‚Äî **—Å–æ–∑–¥–∞—Ç—å –µ–¥–∏–Ω—É—é –ø–æ–ª–∏—Ç–∏–∫—É (`CanRevokeTokens`) –∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –µ—ë**. –≠—Ç–æ –¥–µ–ª–∞–µ—Ç –∫–æ–¥ —á–∏—Å—Ç—ã–º –∏ —É–ø—Ä–∞–≤–ª—è–µ–º—ã–º.