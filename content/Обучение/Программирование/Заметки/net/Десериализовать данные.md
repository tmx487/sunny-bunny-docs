–í —Ç–≤–æ–µ–º —Å–ª—É—á–∞–µ –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `JsonSerializer.Deserialize<T>()` –∏–∑ `System.Text.Json`.

### **üìå –ü—Ä–∏–º–µ—Ä –¥–µ—Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –ø–æ–ª—É—á–µ–Ω–Ω–æ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è**

–î–æ–ø—É—Å—Ç–∏–º, —Ç–≤–æ–∏ —Å–æ–æ–±—â–µ–Ω–∏—è –≤ RabbitMQ –∏–º–µ—é—Ç JSON-—Ñ–æ—Ä–º–∞—Ç:

```json
{
  "toEmail": "raccoon.rocket-487@proton.me",
  "subject": "–ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ email",
  "message": "–í–∞—à –∫–æ–¥ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è: 123456"
}
```

–°–æ–∑–¥–∞–¥–∏–º C# –º–æ–¥–µ–ª—å –¥–ª—è –¥–∞–Ω–Ω—ã—Ö:

```csharp
public class EmailMessage
{
    public string ToEmail { get; set; } = string.Empty;
    public string Subject { get; set; } = string.Empty;
    public string Message { get; set; } = string.Empty;
}
```

–¢–µ–ø–µ—Ä—å –º–æ–∂–Ω–æ –¥–µ—Å–µ—Ä–∏–∞–ª–∏–∑–æ–≤–∞—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ –≤ `ExecuteAsync()`:

```csharp
protected override async Task ExecuteAsync(CancellationToken stoppingToken)
{
    _logger.LogInformation("üöÄ Worker started, listening to RabbitMQ...");

    if (_channel == null)
    {
        _logger.LogError("‚ùå _channel is null! RabbitMQ connection was not initialized.");
        return;
    }

    var consumer = new AsyncEventingBasicConsumer(_channel);
    consumer.Received += async (model, ea) =>
    {
        try
        {
            var body = ea.Body.ToArray();
            var json = Encoding.UTF8.GetString(body);
            _logger.LogInformation($"üì© Received message: {json}");

            var emailMessage = JsonSerializer.Deserialize<EmailMessage>(json);
            if (emailMessage is null)
            {
                _logger.LogError("‚ùå Failed to deserialize message.");
                return;
            }

            await SendEmailAsync(emailMessage.ToEmail, emailMessage.Subject, emailMessage.Message);
            _channel.BasicAck(ea.DeliveryTag, false);
        }
        catch (Exception ex)
        {
            _logger.LogError($"‚ùå Error processing message: {ex.Message}");
            _channel.BasicNack(ea.DeliveryTag, false, true);
        }
    };

    _channel.BasicConsume(queue: _queueName, autoAck: false, consumer: consumer);
    await Task.CompletedTask;
}
```

---

### **üõ† –ß—Ç–æ –∏–∑–º–µ–Ω–∏–ª–æ—Å—å?**

‚úÖ –î–µ—Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏—è JSON ‚Üí –æ–±—ä–µ–∫—Ç `EmailMessage`  
‚úÖ –û–±—Ä–∞–±–æ—Ç–∞–Ω —Å–ª—É—á–∞–π, –µ—Å–ª–∏ JSON –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π  
‚úÖ –í –ª–æ–≥–∞—Ö —Ç–µ–ø–µ—Ä—å –≤–∏–¥–Ω–æ, –∫–∞–∫–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –ø—Ä–∏—à–ª–æ

–¢–µ–ø–µ—Ä—å, –∫–æ–≥–¥–∞ –≤ RabbitMQ –ø—Ä–∏—Ö–æ–¥–∏—Ç JSON-—Å–æ–æ–±—â–µ–Ω–∏–µ, –æ–Ω–æ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–µ–æ–±—Ä–∞–∑—É–µ—Ç—Å—è –≤ `EmailMessage`, –∏ —Å–µ—Ä–≤–∏—Å –æ—Ç–ø—Ä–∞–≤–∏—Ç email. üöÄ