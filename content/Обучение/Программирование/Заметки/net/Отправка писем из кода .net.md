## üìß 1. –û—Ç–ø—Ä–∞–≤–∫–∞ –ø–∏—Å—å–º–∞ –Ω–µ—Å–∫–æ–ª—å–∫–∏–º –∞–¥—Ä–µ—Å–∞—Ç–∞–º

```csharp
var message = new MimeMessage();
message.From.Add(MailboxAddress.Parse("from@example.com"));
message.To.AddRange(new[]
{
    MailboxAddress.Parse("recipient1@example.com"),
    MailboxAddress.Parse("recipient2@example.com"),
    MailboxAddress.Parse("recipient3@example.com")
});
message.Subject = "Hello to multiple recipients";

message.Body = new TextPart("plain")
{
    Text = "This is a message to multiple recipients."
};
```

**–û–±—Ä–∞—Ç–∏ –≤–Ω–∏–º–∞–Ω–∏–µ:**

- –î–ª—è –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –∞–¥—Ä–µ—Å–∞—Ç–æ–≤ –ø—Ä–æ—Å—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ—à—å `AddRange()`.
    
- –ú–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –≤ `Cc` –∏ `Bcc` –∞–Ω–∞–ª–æ–≥–∏—á–Ω–æ:
    

```csharp
message.Cc.Add(MailboxAddress.Parse("someone-cc@example.com"));
message.Bcc.Add(MailboxAddress.Parse("someone-bcc@example.com"));
```

---

## üìÑ 2. –û—Ç–ø—Ä–∞–≤–∫–∞ –ø–∏—Å—å–º–∞ —Å HTML-—Å–æ–¥–µ—Ä–∂–∏–º—ã–º

–ß—Ç–æ–±—ã –ø–∏—Å—å–º–æ –≤—ã–≥–ª—è–¥–µ–ª–æ –∫—Ä–∞—Å–∏–≤–æ (—Ç–∞–±–ª–∏—Ü—ã, —Å—Å—ã–ª–∫–∏, —Å—Ç–∏–ª–∏ –∏ —Ç.–¥.):

```csharp
message.Body = new TextPart("html")
{
    Text = "<h1>Hello!</h1><p>This is a <b>test email</b> with <i>HTML content</i>.</p>"
};
```

**–í–∞–∂–Ω–æ:**  
`TextPart("html")` –≤–º–µ—Å—Ç–æ `TextPart("plain")`.  
–¢–æ–≥–¥–∞ –∫–ª–∏–µ–Ω—Ç (Outlook, Gmail –∏ —Ç.–ø.) –ø–æ–π–º–µ—Ç, —á—Ç–æ —ç—Ç–æ HTML.

---

## üìé 3. –û—Ç–ø—Ä–∞–≤–∫–∞ –ø–∏—Å—å–º–∞ —Å –≤–ª–æ–∂–µ–Ω–∏–µ–º (attachments)

```csharp
var body = new TextPart("plain")
{
    Text = "Please see the attached file."
};

var attachment = new MimePart("application", "octet-stream")
{
    Content = new MimeContent(File.OpenRead("path/to/your/file.pdf")),
    ContentDisposition = new ContentDisposition(ContentDisposition.Attachment),
    ContentTransferEncoding = ContentEncoding.Base64,
    FileName = "file.pdf"
};

// –°–æ–±–∏—Ä–∞–µ–º –ø–∏—Å—å–º–æ –∫–∞–∫ Multipart
var multipart = new Multipart("mixed");
multipart.Add(body);
multipart.Add(attachment);

message.Body = multipart;
```

**–ß—Ç–æ —Ç—É—Ç –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç:**

- –û—Å–Ω–æ–≤–Ω–æ–µ —Ç–µ–ª–æ –ø–∏—Å—å–º–∞ (`TextPart`).
    
- –í–ª–æ–∂–µ–Ω–∏–µ (`MimePart`).
    
- –í—Å—ë –æ–±—ä–µ–¥–∏–Ω—è–µ–º —á–µ—Ä–µ–∑ `Multipart("mixed")` (—ç—Ç–æ –∑–Ω–∞—á–∏—Ç "—Ç–µ–ª–æ + —Ñ–∞–π–ª—ã").
    

---

## üß† –ú–∏–Ω–∏-—Å–≤–æ–¥–∫–∞

|–ß—Ç–æ –Ω—É–∂–Ω–æ|–ß—Ç–æ –ø–∏—Å–∞—Ç—å|
|---|---|
|–ü—Ä–æ—Å—Ç–æ–µ –ø–∏—Å—å–º–æ|`TextPart("plain")`|
|–ü–∏—Å—å–º–æ —Å HTML|`TextPart("html")`|
|–ü–∏—Å—å–º–æ —Å –Ω–µ—Å–∫–æ–ª—å–∫–∏–º–∏ –ø–æ–ª—É—á–∞—Ç–µ–ª—è–º–∏|`To.AddRange()`|
|–ü–∏—Å—å–º–æ —Å –≤–ª–æ–∂–µ–Ω–∏–µ–º|`Multipart("mixed")`|

---

## ‚ö° –ü—Ä–∏–º–µ—Ä –ø–æ–ª–Ω–æ–≥–æ –æ—Ç–ø—Ä–∞–≤–∫–∏ —Å HTML + –≤–ª–æ–∂–µ–Ω–∏–µ–º + –Ω–µ—Å–∫–æ–ª—å–∫–∏–º–∏ –∞–¥—Ä–µ—Å–∞—Ç–∞–º–∏:

```csharp
var message = new MimeMessage();
message.From.Add(MailboxAddress.Parse("from@example.com"));
message.To.AddRange(new[]
{
    MailboxAddress.Parse("recipient1@example.com"),
    MailboxAddress.Parse("recipient2@example.com")
});
message.Subject = "HTML Email with Attachment";

// HTML content
var body = new TextPart("html")
{
    Text = "<h2>Here is your document</h2><p>See the attachment below.</p>"
};

// Attachment
var attachment = new MimePart("application", "pdf")
{
    Content = new MimeContent(File.OpenRead("path/to/file.pdf")),
    ContentDisposition = new ContentDisposition(ContentDisposition.Attachment),
    ContentTransferEncoding = ContentEncoding.Base64,
    FileName = "document.pdf"
};

// Combine body and attachment
var multipart = new Multipart("mixed");
multipart.Add(body);
multipart.Add(attachment);

message.Body = multipart;

using var client = new MailKit.Net.Smtp.SmtpClient();
await client.ConnectAsync("smtp.example.com", 587, MailKit.Security.SecureSocketOptions.StartTls);
await client.AuthenticateAsync("username", "password");
await client.SendAsync(message);
await client.DisconnectAsync(true);
```