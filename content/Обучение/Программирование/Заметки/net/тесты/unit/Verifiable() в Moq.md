–í **Moq** –º–µ—Ç–æ–¥ `.Verifiable()` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –ø–æ–º–µ—Ç–∫–∏ –Ω–∞—Å—Ç—Ä–æ–µ–∫ –º–æ–∫–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –ø—Ä–æ–≤–µ—Ä–µ–Ω—ã –Ω–∞ –≤—ã–∑–æ–≤ –ø–æ–∑–∂–µ —Å –ø–æ–º–æ—â—å—é `Verify()`. –≠—Ç–æ –ø–æ–º–æ–≥–∞–µ—Ç —É–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ –æ–∂–∏–¥–∞–µ–º—ã–µ –º–µ—Ç–æ–¥—ã –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ –≤—ã–∑—ã–≤–∞–ª–∏—Å—å –≤ —Ç–µ—Å—Ç–∏—Ä—É–µ–º–æ–º –∫–æ–¥–µ.

---

### üìå **–ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç `Verifiable()`?**

–ö–æ–≥–¥–∞ —Ç—ã –¥–æ–±–∞–≤–ª—è–µ—à—å `.Verifiable()`, Moq –ø–æ–º–µ—á–∞–µ—Ç —ç—Ç–æ—Ç `Setup` –∫–∞–∫ –≤–∞–∂–Ω—ã–π. –ü–æ–∑–∂–µ, –ø—Ä–∏ –≤—ã–∑–æ–≤–µ `Verify()`, Moq –ø—Ä–æ–≤–µ—Ä—è–µ—Ç, –±—ã–ª –ª–∏ —ç—Ç–æ—Ç –º–µ—Ç–æ–¥ –≤—ã–∑–≤–∞–Ω. –ï—Å–ª–∏ –º–µ—Ç–æ–¥ –Ω–µ –±—ã–ª –≤—ã–∑–≤–∞–Ω, `Verify()` –≤—ã–±—Ä–æ—Å–∏—Ç –∏—Å–∫–ª—é—á–µ–Ω–∏–µ –∏ —Ç–µ—Å—Ç –Ω–µ –ø—Ä–æ–π–¥–µ—Ç.

#### **–ü—Ä–æ—Å—Ç–æ–π –ø—Ä–∏–º–µ—Ä –±–µ–∑ `Verifiable()`**

```csharp
_mockService.Setup(s => s.DoSomething()).Returns(true);

_mockService.Object.DoSomething(); // –í—ã–∑—ã–≤–∞–µ–º –º–µ—Ç–æ–¥

_mockService.Verify(s => s.DoSomething(), Times.Once); // –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ –º–µ—Ç–æ–¥ –±—ã–ª –≤—ã–∑–≤–∞–Ω 1 —Ä–∞–∑
```

–¢–µ—Å—Ç –ø—Ä–æ–π–¥–µ—Ç, –µ—Å–ª–∏ –º–µ—Ç–æ–¥ `DoSomething()` –≤—ã–∑–≤–∞–Ω —Ä–æ–≤–Ω–æ 1 —Ä–∞–∑.

---

#### **–ü—Ä–∏–º–µ—Ä —Å `Verifiable()`**

```csharp
_mockService
    .Setup(s => s.DoSomething())
    .Returns(true)
    .Verifiable();

_mockService.Object.DoSomething();

_mockService.Verify(); // –ü—Ä–æ–≤–µ—Ä–∏—Ç –≤—Å–µ –º–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –≤—ã–∑–æ–≤—ã —Å `Verifiable()`
```

–ó–¥–µ—Å—å **`Verify()` –±–µ–∑ –∞—Ä–≥—É–º–µ–Ω—Ç–æ–≤ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –í–°–ï –≤—ã–∑–æ–≤—ã**, –∫–æ—Ç–æ—Ä—ã–µ –±—ã–ª–∏ –ø–æ–º–µ—á–µ–Ω—ã `Verifiable()`.

#### **–ï—â–µ –ø—Ä–∏–º–µ—Ä —Å `Verifiable()`**

```csharp
[Fact]
public async Task DeleteManyTopics_Should_ReturnSuccess_WhenAllTopicsExist()
{
    // Arrange
    var topicsToDelete = new List<Topic> { 
        CreateDefaultTopic(),
        CreateDefaultTopic(),
        CreateDefaultTopic(),
    };

    // –ú–æ–∫–∞–µ–º –º–µ—Ç–æ–¥ GetFilteredAsync —Å Verifiable
    _topicRepository
        .Setup(repo => repo.GetFilteredAsync(It.IsAny<Expression<Func<Topic, bool>>>(), It.IsAny<CancellationToken>()))
        .ReturnsAsync(topicsToDelete)
        .Verifiable();  // –≠—Ç–æ –∑–Ω–∞—á–∏—Ç, —á—Ç–æ —ç—Ç–æ—Ç –º–µ—Ç–æ–¥ –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –≤—ã–∑–≤–∞–Ω –≤ —Ç–µ—Å—Ç–µ

    // Act
    var result = await _topicService.DeleteManyTopics(topicsToDelete.Select(t => t.Id), CancellationToken.None);

    // Assert
    result.IsSuccess.Should().BeTrue();
    
    // –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ RemoveRange –±—ã–ª –≤—ã–∑–≤–∞–Ω
    _topicRepository.Verify(repo => repo.RemoveRange(topicsToDelete), Times.Once);
    
    // –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ –º–µ—Ç–æ–¥ SaveChangesAsync –±—ã–ª –≤—ã–∑–≤–∞–Ω
    _unitOfWork.Verify(u => u.SaveChangesAsync(It.IsAny<CancellationToken>()), Times.Once);

    // –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ GetFilteredAsync –±—ã–ª –≤—ã–∑–≤–∞–Ω
    _topicRepository.Verify();  // –ú—ã –≤—ã–∑—ã–≤–∞–µ–º Verify() –±–µ–∑ –∞—Ä–≥—É–º–µ–Ω—Ç–æ–≤, —á—Ç–æ–±—ã –ø—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ Setup() –±—ã–ª –≤—ã–∑–≤–∞–Ω; –µ—Å–ª–∏ –Ω–∏–≥–¥–µ –≤ –∫–æ–¥–µ –Ω–µ –≤—Å—Ç—Ä–µ—Ç–∏–ª—Å—è Verifiable(), —Ç–æ –¥–∞–Ω–Ω–∞—è —Å—Ç—Ä–æ–∫–∞ –Ω–µ –∏–º–µ–µ—Ç —Å–º—ã—Å–ª–∞
}
```
### –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ–¥:

1. **Setup**: –ú–æ–∫–∏—Ä—É–µ–º –≤—ã–∑–æ–≤ –º–µ—Ç–æ–¥–∞ `GetFilteredAsync` –Ω–∞ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏ —Å –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏.
    - –ú—ã —Ç–∞–∫–∂–µ –≤—ã–∑—ã–≤–∞–µ–º `Verifiable()` –¥–ª—è —ç—Ç–æ–≥–æ –º–µ—Ç–æ–¥–∞, —á—Ç–æ –≥–æ–≤–æ—Ä–∏—Ç –±–∏–±–ª–∏–æ—Ç–µ–∫–µ Moq: "–≠—Ç–æ—Ç –º–µ—Ç–æ–¥ –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –≤—ã–∑–≤–∞–Ω, –∏–Ω–∞—á–µ —Ç–µ—Å—Ç –Ω–µ –¥–æ–ª–∂–µ–Ω –ø—Ä–æ–π—Ç–∏".
2. **Act**: –ó–∞–ø—É—Å–∫–∞–µ–º –¥–µ–π—Å—Ç–≤–∏–µ ‚Äî –≤ –¥–∞–Ω–Ω–æ–º —Å–ª—É—á–∞–µ –≤—ã–∑—ã–≤–∞–µ–º –º–µ—Ç–æ–¥ —Å–µ—Ä–≤–∏—Å–∞ `DeleteManyTopics`.
3. **Verify**: –ü–æ—Å–ª–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –¥–µ–π—Å—Ç–≤–∏—è –≤—ã–∑—ã–≤–∞–µ–º `Verify()` –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏, –±—ã–ª –ª–∏ –≤—ã–∑–≤–∞–Ω –º–µ—Ç–æ–¥, –∫–æ—Ç–æ—Ä—ã–π –º—ã –ø–æ–º–µ—Ç–∏–ª–∏ –∫–∞–∫ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Å –ø–æ–º–æ—â—å—é `Verifiable()`.

---

### üìå **–ö–æ–≥–¥–∞ `Verifiable()` –ø–æ–ª–µ–∑–µ–Ω?**

1. **–ö–æ–≥–¥–∞ –º–Ω–æ–≥–æ –º–æ–∫–æ–≤**
    
    - –ï—Å–ª–∏ —É —Ç–µ–±—è –Ω–µ—Å–∫–æ–ª—å–∫–æ `Setup()`, –≤–º–µ—Å—Ç–æ –º–Ω–æ–∂–µ—Å—Ç–≤–∞ `Verify()` –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –æ–¥–∏–Ω `Verify()` –¥–ª—è –≤—Å–µ—Ö.
2. **–ö–æ–≥–¥–∞ –∑–∞–±—ã–≤–∞–µ—à—å `Verify()`**
    
    - –ï—Å–ª–∏ –∑–∞–±—ã—Ç—å `Verify()`, `Verifiable()` –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å `VerifyAll()` –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –ø—Ä–æ–≤–µ—Ä–∫–∏.

**–ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å**:

- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è, –∫–æ–≥–¥–∞ –≤–∞–∂–Ω–æ —É–¥–æ—Å—Ç–æ–≤–µ—Ä–∏—Ç—å—Å—è, —á—Ç–æ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã–µ –º–µ—Ç–æ–¥—ã –±—ã–ª–∏ –≤—ã–∑–≤–∞–Ω—ã –≤ —Ö–æ–¥–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —Ç–µ—Å—Ç–∞.
- –ü–æ–ª–µ–∑–Ω–æ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ side-effects (–ø–æ–±–æ—á–Ω—ã—Ö —ç—Ñ—Ñ–µ–∫—Ç–æ–≤) ‚Äî –Ω–∞–ø—Ä–∏–º–µ—Ä, –µ—Å–ª–∏ –≤—ã —Ö–æ—Ç–∏—Ç–µ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ –ø–æ—Å–ª–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∫–∞–∫–æ–π-—Ç–æ –æ–ø–µ—Ä–∞—Ü–∏–∏ –±—ã–ª –≤—ã–∑–≤–∞–Ω –º–µ—Ç–æ–¥ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö.
---

### üìå **–ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–π –º–µ—Ç–æ–¥ `VerifyAll()`**

```csharp
_mockService
    .Setup(s => s.DoSomething())
    .Returns(true)
    .Verifiable();

_mockService
    .Setup(s => s.DoSomethingElse())
    .Returns(false)
    .Verifiable();

_mockService.Object.DoSomething();
_mockService.Object.DoSomethingElse();

_mockService.VerifyAll(); // –ü—Ä–æ–≤–µ—Ä–∏—Ç –í–°–ï –ø–æ–º–µ—á–µ–Ω–Ω—ã–µ `Verifiable()`
```

–ï—Å–ª–∏ **–ª—é–±–æ–π `Verifiable()` –º–µ—Ç–æ–¥ –Ω–µ –≤—ã–∑–≤–∞–Ω**, —Ç–µ—Å—Ç —É–ø–∞–¥–µ—Ç.

---

### üõë **–ö–æ–≥–¥–∞ –ù–ï –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `Verifiable()`?**

- –ï—Å–ª–∏ —É —Ç–µ–±—è **–º–Ω–æ–≥–æ –Ω–∞—Å—Ç—Ä–æ–µ–∫, –Ω–æ –Ω–µ –≤—Å–µ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –ø—Ä–æ–≤–µ—Ä–µ–Ω—ã** ‚Äî –ª—É—á—à–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `Verify()` —Ç–æ–ª—å–∫–æ –¥–ª—è –Ω—É–∂–Ω—ã—Ö –º–æ–∫–æ–≤.
- –í **—Å–ª–æ–∂–Ω—ã—Ö —Ç–µ—Å—Ç–∞—Ö**, –≥–¥–µ –Ω–µ—Å–∫–æ–ª—å–∫–æ `Verify()`, `Verifiable()` –º–æ–∂–µ—Ç –∑–∞–ø—É—Ç–∞—Ç—å, –∫–∞–∫–∏–µ –≤—ã–∑–æ–≤—ã –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –ø—Ä–æ–≤–µ—Ä–µ–Ω—ã.

### üöÄ **–í—ã–≤–æ–¥**

‚úÖ `Verifiable()` —É–¥–æ–±–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å, –µ—Å–ª–∏ —É —Ç–µ–±—è –º–Ω–æ–≥–æ –º–æ–∫–æ–≤, –∏ —Ç—ã —Ö–æ—á–µ—à—å –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞—Ç—å `Verify()`.  
‚ùå –ù–æ –µ—Å–ª–∏ –Ω—É–∂–Ω–æ –ø—Ä–æ–≤–µ—Ä—è—Ç—å —Ç–æ–ª—å–∫–æ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ –≤—ã–∑–æ–≤—ã, –ª—É—á—à–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `Verify()` –Ω–∞–ø—Ä—è–º—É—é.