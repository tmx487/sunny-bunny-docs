>
>–ò–º–µ–Ω–æ–≤–∞–Ω–∏–µ –º–µ—Ç–æ–¥–æ–≤ –≤ —Ç–µ—Å—Ç–∞—Ö (–æ–¥–∏–Ω –∏–∑ –ø–æ–¥—Ö–æ–¥–æ–≤)
>
>\[ThingUnderTest]\_Shoul\_\[ExpectedResult]\_\[Condition]
>

`ThingUnderTest` - method's name, which will be tested
## **1Ô∏è‚É£ –ù–∞—á–Ω–∏ —Å –º–æ–¥—É–ª—å–Ω—ã—Ö —Ç–µ—Å—Ç–æ–≤ (Unit Tests)**

–ú–æ–¥—É–ª—å–Ω—ã–µ —Ç–µ—Å—Ç—ã **–±—ã—Å—Ç—Ä—ã–µ, –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ, –ø—Ä–æ–≤–µ—Ä—è—é—Ç –ª–æ–≥–∏–∫—É –±–µ–∑ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö –∏ –≤–Ω–µ—à–Ω–∏—Ö –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π**.

### **üìå –ß—Ç–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –≤ –ø–µ—Ä–≤—É—é –æ—á–µ—Ä–µ–¥—å?**

‚úÖ **–ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫—É (`Application` –∏ `Domain` —Å–ª–æ–∏)**:

- **–ê–≥—Ä–µ–≥–∞—Ç—ã –∏ —Å—É—â–Ω–æ—Å—Ç–∏ (Entity, Aggregate Root)**
- **–ë–∏–∑–Ω–µ—Å-–ø—Ä–∞–≤–∏–ª–∞ (`Domain Services`, `Value Objects`)**
- **–û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –∫–æ–º–∞–Ω–¥ –∏ –∑–∞–ø—Ä–æ—Å–æ–≤ (`MediatR Command/Query Handlers`)**

‚úÖ **–§—É–Ω–∫—Ü–∏–∏, –∫–æ—Ç–æ—Ä—ã–µ –ø—Ä–∏–Ω–∏–º–∞—é—Ç –¥–∞–Ω–Ω—ã–µ –∏ –≤–æ–∑–≤—Ä–∞—â–∞—é—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç**

- **–ú–µ—Ç–æ–¥—ã —Å–µ—Ä–≤–∏—Å–æ–≤ (`Application Services`, `Domain Services`)**
- **–§–∞–±—Ä–∏—á–Ω—ã–µ –º–µ—Ç–æ–¥—ã –∏ `Create`-–º–µ—Ç–æ–¥—ã –∞–≥—Ä–µ–≥–∞—Ç–æ–≤**
- **–í–∞–ª–∏–¥–∞—Ü–∏–∏ (FluentValidation –∏–ª–∏ –∫–∞—Å—Ç–æ–º–Ω—ã–µ)**

### **‚ùå –ß–µ–≥–æ –ù–ï —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –≤ –º–æ–¥—É–ª—å–Ω—ã—Ö —Ç–µ—Å—Ç–∞—Ö?**

- **EF Core (`DbContext`, SQL-–∑–∞–ø—Ä–æ—Å—ã, –º–∏–≥—Ä–∞—Ü–∏–∏)** ‚Üí –¢–µ—Å—Ç–∏—Ä—É–µ—Ç—Å—è –≤ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã—Ö —Ç–µ—Å—Ç–∞—Ö.
- **–ö–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä—ã (`Web API`)** ‚Üí –¢–µ—Å—Ç–∏—Ä—É–µ—Ç—Å—è —á–µ—Ä–µ–∑ **–∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã** –∏–ª–∏ **—Ç–µ—Å—Ç—ã –Ω–∞ —É—Ä–æ–≤–Ω–µ API**.

---

### **2Ô∏è‚É£ –ù–∞–ø–∏—à–∏ –ø–µ—Ä–≤—ã–µ unit-—Ç–µ—Å—Ç—ã**

#### **üìå –ü—Ä–∏–º–µ—Ä —Ç–µ—Å—Ç–∞ –¥–æ–º–µ–Ω–Ω–æ–π –ª–æ–≥–∏–∫–∏**

–î–æ–ø—É—Å—Ç–∏–º, —É —Ç–µ–±—è –µ—Å—Ç—å **–∞–≥—Ä–µ–≥–∞—Ç `Topic`** —Å –º–µ—Ç–æ–¥–æ–º `Create()`, –∫–æ—Ç–æ—Ä—ã–π —Å–æ–∑–¥–∞—ë—Ç –Ω–æ–≤—ã–π `Topic` —Å –ø—Ä–∞–≤–∏–ª–∞–º–∏.

```csharp
public class TopicTests
{
    [Fact]
    public void Create_ShouldReturnValidTopic_WhenDataIsValid()
    {
        // Arrange
        var title = "Test Title";
        var shortDescription = "Short Description";
        var requirements = "Requirements";
        var reasonToCreate = "Reason";
        var userId = Guid.NewGuid();

        // Act
        var topic = Topic.Create(title, shortDescription, requirements, reasonToCreate, userId);

        // Assert
        Assert.NotNull(topic);
        Assert.Equal(title, topic.Title);
        Assert.Equal(shortDescription, topic.ShortDescription);
        Assert.Equal(requirements, topic.Requirements);
        Assert.Equal(reasonToCreate, topic.ReasonToCreate);
        Assert.Equal(userId, topic.UserId);
    }
}
```

‚úîÔ∏è –≠—Ç–æ—Ç —Ç–µ—Å—Ç **–Ω–µ –∑–∞–≤–∏—Å–∏—Ç** –æ—Ç –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö.  
‚úîÔ∏è –ü—Ä–æ–≤–µ—Ä—è–µ—Ç **—á–∏—Å—Ç—É—é –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫—É**.

---

## **3Ô∏è‚É£ –ü–æ–∫—Ä–æ–π —Ç–µ—Å—Ç–∞–º–∏ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –∫–æ–º–∞–Ω–¥ (MediatR)**

–û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –∫–æ–º–∞–Ω–¥ (`Command Handlers`) —Å–æ–¥–µ—Ä–∂–∞—Ç **–∫–ª—é—á–µ–≤—É—é –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫—É** –∏ —á–∞—Å—Ç–æ —Ä–∞–±–æ—Ç–∞—é—Ç —Å `IRepository<T>`.

### **üìå –ü—Ä–∏–º–µ—Ä —Ç–µ—Å—Ç–∞ `CommandHandler`**

–î–æ–ø—É—Å—Ç–∏–º, —É —Ç–µ–±—è –µ—Å—Ç—å **–∫–æ–º–∞–Ω–¥–∞ `CreateTopicCommand`** –∏ –µ—ë –æ–±—Ä–∞–±–æ—Ç—á–∏–∫:

```csharp
public class CreateTopicCommandHandler : IRequestHandler<CreateTopicCommand, Result>
{
    private readonly ITopicRepository _topicRepository;

    public CreateTopicCommandHandler(ITopicRepository topicRepository)
    {
        _topicRepository = topicRepository;
    }

    public async Task<Result> Handle(CreateTopicCommand request, CancellationToken cancellationToken)
    {
        var topic = Topic.Create(request.Title, request.ShortDescription, request.Requirements, request.ReasonToCreate, request.UserId);

        await _topicRepository.AddAsync(topic, cancellationToken);
        return Result.Success();
    }
}
```

–¢–µ–ø–µ—Ä—å —Ç–µ—Å—Ç–∏—Ä—É–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ **–±–µ–∑ —Ä–µ–∞–ª—å–Ω–æ–≥–æ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è** ‚Äî **–∑–∞–º–æ–∫–∞–µ–º `ITopicRepository`** —Å –ø–æ–º–æ—â—å—é **Moq**:

```csharp
public class CreateTopicCommandHandlerTests
{
    private readonly Mock<ITopicRepository> _topicRepositoryMock;
    private readonly CreateTopicCommandHandler _handler;

    public CreateTopicCommandHandlerTests()
    {
        _topicRepositoryMock = new Mock<ITopicRepository>();
        _handler = new CreateTopicCommandHandler(_topicRepositoryMock.Object);
    }

    [Fact]
    public async Task Handle_ShouldCallRepository_WhenTopicIsCreated()
    {
        // Arrange
        var command = new CreateTopicCommand("Title", "ShortDesc", "Req", "Reason", Guid.NewGuid());

        // Act
        var result = await _handler.Handle(command, CancellationToken.None);

        // Assert
        Assert.True(result.IsSuccess);
        _topicRepositoryMock.Verify(r => r.AddAsync(It.IsAny<Topic>(), It.IsAny<CancellationToken>()), Times.Once);
    }
}
```

‚úîÔ∏è –≠—Ç–æ—Ç —Ç–µ—Å—Ç **–Ω–µ —Ç—Ä–µ–±—É–µ—Ç –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö**, –ø–æ—Ç–æ–º—É —á—Ç–æ –º–æ–∫–∞–µ—Ç `ITopicRepository`.  
‚úîÔ∏è –ü—Ä–æ–≤–µ—Ä—è–µ—Ç **–±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫—É –±–µ–∑ –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã**.

---

## **4Ô∏è‚É£ –î–æ–±–∞–≤—å –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã (Integration Tests)**

–ú–æ–¥—É–ª—å–Ω—ã–µ —Ç–µ—Å—Ç—ã **–∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω—ã** –∏ **–Ω–µ —Ç–µ—Å—Ç–∏—Ä—É—é—Ç –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö**, –Ω–æ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ –≤–∞–∂–Ω–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å, **–∫–∞–∫ –∫–æ–¥ —Ä–∞–±–æ—Ç–∞–µ—Ç —Å —Ä–µ–∞–ª—å–Ω–æ–π –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–æ–π**.

### **üìå –ß—Ç–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –≤ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã—Ö —Ç–µ—Å—Ç–∞—Ö?**

‚úÖ **–†–∞–±–æ—Ç—É `Repository` —Å —Ä–µ–∞–ª—å–Ω–æ–π –ë–î (EF Core, PostgreSQL, etc.)**  
‚úÖ **API-–∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä—ã (`Web API`)**  
‚úÖ **–ü–æ–ª–Ω—ã–π —Å—Ü–µ–Ω–∞—Ä–∏–π –æ—Ç –∑–∞–ø—Ä–æ—Å–∞ –¥–æ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –≤ –ë–î**

### **–ü—Ä–∏–º–µ—Ä –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω–æ–≥–æ —Ç–µ—Å—Ç–∞ —Å `WebApplicationFactory`**

```csharp
public class TopicControllerTests : IClassFixture<WebApplicationFactory<Program>>
{
    private readonly HttpClient _client;

    public TopicControllerTests(WebApplicationFactory<Program> factory)
    {
        _client = factory.CreateClient();
    }

    [Fact]
    public async Task CreateManyTopics_ShouldReturnOk_WhenValidRequest()
    {
        // Arrange
        var request = new CreateManyTopicsRequest(new[]
        {
            new CreateTopicRequest("Title", "ShortDesc", "Req", "Reason")
        });

        var jsonContent = new StringContent(JsonConvert.SerializeObject(request), Encoding.UTF8, "application/json");

        // Act
        var response = await _client.PostAsync("/api/topics", jsonContent);

        // Assert
        response.EnsureSuccessStatusCode();
    }
}
```

‚úîÔ∏è –ó–∞–ø—É—Å–∫–∞–µ—Ç —Ä–µ–∞–ª—å–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ (–Ω–æ —Å —Ç–µ—Å—Ç–æ–≤–æ–π –ë–î).  
‚úîÔ∏è –ü—Ä–æ–≤–µ—Ä—è–µ—Ç **–ø–æ–ª–Ω—ã–π —Ü–∏–∫–ª HTTP-–∑–∞–ø—Ä–æ—Å–∞**.

---

## **üî• –ö–∞–∫ –≤–Ω–µ–¥—Ä–∏—Ç—å —Ç–µ—Å—Ç—ã –≤ –ø—Ä–æ–µ–∫—Ç?**

1. **–°–æ–∑–¥–∞–π –ø—Ä–æ–µ–∫—Ç –¥–ª—è —Ç–µ—Å—Ç–æ–≤**
    
    ```sh
    dotnet new xunit -n YourProject.Tests
    ```
    
2. **–î–æ–±–∞–≤—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –≤ `YourProject.Tests.csproj`**
    
    ```xml
    <ItemGroup>
        <PackageReference Include="MediatR" Version="12.0.1" />
        <PackageReference Include="Moq" Version="4.20.69" />
        <PackageReference Include="Microsoft.EntityFrameworkCore.InMemory" Version="8.0.0" />
        <PackageReference Include="Microsoft.AspNetCore.Mvc.Testing" Version="8.0.0" />
        <PackageReference Include="xunit" Version="2.4.2" />
    </ItemGroup>
    ```
    
3. **–ó–∞–ø—É—Å—Ç–∏ —Ç–µ—Å—Ç—ã:**
    
    ```sh
    dotnet test
    ```
    

---

## **üéØ –ò—Ç–æ–≥: –° —á–µ–≥–æ –Ω–∞—á–∞—Ç—å?**

**1Ô∏è‚É£ –ú–æ–¥—É–ª—å–Ω—ã–µ —Ç–µ—Å—Ç—ã** (—Å—É—â–Ω–æ—Å—Ç–∏, —Å–µ—Ä–≤–∏—Å—ã, –∫–æ–º–∞–Ω–¥–Ω—ã–µ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏).  
**2Ô∏è‚É£ –¢–µ—Å—Ç—ã –∫–æ–º–∞–Ω–¥/–∑–∞–ø—Ä–æ—Å–æ–≤ (`MediatR Handlers`)** —Å –º–æ–∫–∞–º–∏ `IRepository<T>`.  
**3Ô∏è‚É£ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã** ‚Üí –ø—Ä–æ–≤–µ—Ä—è—é—Ç `Repository`, API, –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ —Å –ë–î.  
**4Ô∏è‚É£ –î–æ–±–∞–≤—å —Ç–µ—Å—Ç—ã –≤ CI/CD** (GitHub Actions, GitLab CI/CD).

–ï—Å–ª–∏ —Ç–æ–ª—å–∫–æ –Ω–∞—á–∏–Ω–∞–µ—à—å ‚Äî **–Ω–∞—á–Ω–∏ —Å –º–æ–¥—É–ª—å–Ω—ã—Ö —Ç–µ—Å—Ç–æ–≤ –≤ `Domain` –∏ `Application`**.

üõ† **–õ—É—á—à–∏–π –ø–æ–¥—Ö–æ–¥:**

- **–ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞ ‚Üí Unit-—Ç–µ—Å—Ç—ã**
- **–ò–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞ (EF Core) ‚Üí Integration-—Ç–µ—Å—Ç—ã**
- **API ‚Üí WebApplicationFactory**

‚ö° **–ü–æ–∫—Ä—ã–≤–∞—è –≤–∞–∂–Ω—É—é –ª–æ–≥–∏–∫—É —Ç–µ—Å—Ç–∞–º–∏, —Ç—ã –∑–∞—â–∏—Ç–∏—à—å —Å–∏—Å—Ç–µ–º—É –æ—Ç –±–∞–≥–æ–≤ –∏ —Ä–µ–≥—Ä–µ—Å—Å–∏–π.** üöÄ

# **üöÄ –û—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è –ø—Ä–æ–µ–∫—Ç–∞ –∏ –ø–∞–ø–æ–∫ —Å —Ç–µ—Å—Ç–∞–º–∏ –≤ Solution**

## **1Ô∏è‚É£ –û–±—â–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–æ–≤ –≤ Solution**

```
/YourSolution
‚îÇ‚îÄ‚îÄ /src
‚îÇ   ‚îú‚îÄ‚îÄ YourProject.API               # Web API (Controllers, Startup)
‚îÇ   ‚îú‚îÄ‚îÄ YourProject.Application       # Application Layer (CQRS, Handlers, Services)
‚îÇ   ‚îú‚îÄ‚îÄ YourProject.Domain            # Domain Layer (Entities, Value Objects, Aggregates)
‚îÇ   ‚îú‚îÄ‚îÄ YourProject.Infrastructure    # Infrastructure (EF Core, Repositories, External Services)
‚îÇ‚îÄ‚îÄ /tests
‚îÇ   ‚îú‚îÄ‚îÄ YourProject.Domain.Tests       # –ú–æ–¥—É–ª—å–Ω—ã–µ —Ç–µ—Å—Ç—ã Domain —Å–ª–æ—è
‚îÇ   ‚îú‚îÄ‚îÄ YourProject.Application.Tests  # –ú–æ–¥—É–ª—å–Ω—ã–µ —Ç–µ—Å—Ç—ã Application —Å–ª–æ—è
‚îÇ   ‚îú‚îÄ‚îÄ YourProject.Infrastructure.Tests  # –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã –ë–î (EF Core)
‚îÇ   ‚îú‚îÄ‚îÄ YourProject.API.Tests          # –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ / —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ —Ç–µ—Å—Ç—ã API (WebApplicationFactory)
‚îÇ   ‚îú‚îÄ‚îÄ YourProject.EndToEnd.Tests      # End-to-End (UI –∏–ª–∏ API) —Ç–µ—Å—Ç—ã (–µ—Å–ª–∏ –µ—Å—Ç—å)
```

---

## **2Ô∏è‚É£ –ß—Ç–æ –∫—É–¥–∞ –ø–æ–º–µ—â–∞—Ç—å?**

### **‚úÖ `YourProject.Domain.Tests` (–¢–µ—Å—Ç—ã –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∏)**

**üõ† –ß—Ç–æ —Ç–µ—Å—Ç–∏—Ä—É–µ–º?**

- **–ê–≥—Ä–µ–≥–∞—Ç—ã, —Å—É—â–Ω–æ—Å—Ç–∏ (`Entity`, `AggregateRoot`)**
- **Value Objects**
- **–ë–∏–∑–Ω–µ—Å-–ø—Ä–∞–≤–∏–ª–∞ (Domain Services, Factories)**

**üìå –ü—Ä–∏–º–µ—Ä —Ç–µ—Å—Ç–∞ –¥–ª—è —Å—É—â–Ω–æ—Å—Ç–∏ `Topic`:**

```csharp
public class TopicTests
{
    [Fact]
    public void Create_ShouldReturnValidTopic_WhenDataIsValid()
    {
        var topic = Topic.Create("Title", "ShortDesc", "Req", "Reason", Guid.NewGuid());
        Assert.NotNull(topic);
        Assert.Equal("Title", topic.Title);
    }
}
```

---

### **‚úÖ `YourProject.Application.Tests` (–¢–µ—Å—Ç—ã Application —Å–ª–æ—è)**

**üõ† –ß—Ç–æ —Ç–µ—Å—Ç–∏—Ä—É–µ–º?**

- **MediatR Handlers (`CommandHandler`, `QueryHandler`)**
- **Application Services**
- **–í–∞–ª–∏–¥–∞—Ü–∏–∏ (`FluentValidation`)**
- **–ú–æ–∫–∏—Ä—É–µ–º `IRepository<T>` —á–µ—Ä–µ–∑ `Moq`**

**üìå –ü—Ä–∏–º–µ—Ä —Ç–µ—Å—Ç–∞ `CreateTopicCommandHandler`:**

```csharp
public class CreateTopicCommandHandlerTests
{
    private readonly Mock<ITopicRepository> _repositoryMock;
    private readonly CreateTopicCommandHandler _handler;

    public CreateTopicCommandHandlerTests()
    {
        _repositoryMock = new Mock<ITopicRepository>();
        _handler = new CreateTopicCommandHandler(_repositoryMock.Object);
    }

    [Fact]
    public async Task Handle_ShouldSaveTopic_WhenValidRequest()
    {
        var command = new CreateTopicCommand("Title", "ShortDesc", "Req", "Reason", Guid.NewGuid());

        var result = await _handler.Handle(command, CancellationToken.None);

        Assert.True(result.IsSuccess);
        _repositoryMock.Verify(r => r.AddAsync(It.IsAny<Topic>(), It.IsAny<CancellationToken>()), Times.Once);
    }
}
```

---

### **‚úÖ `YourProject.Infrastructure.Tests` (–¢–µ—Å—Ç—ã –ë–î –∏ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–µ–≤)**

**üõ† –ß—Ç–æ —Ç–µ—Å—Ç–∏—Ä—É–µ–º?**

- **–†–µ–∞–ª—å–Ω—ã–µ `Repository` –∏ `DbContext` —Å `InMemoryDatabase` –∏–ª–∏ `Testcontainers`**

**üìå –ü—Ä–∏–º–µ—Ä —Ç–µ—Å—Ç–∞ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è —Å InMemory –ë–î:**

```csharp
public class TopicRepositoryTests
{
    private readonly YourDbContext _context;
    private readonly TopicRepository _repository;

    public TopicRepositoryTests()
    {
        var options = new DbContextOptionsBuilder<YourDbContext>()
            .UseInMemoryDatabase(databaseName: "TestDb")
            .Options;

        _context = new YourDbContext(options);
        _repository = new TopicRepository(_context);
    }

    [Fact]
    public async Task AddAsync_ShouldSaveTopic_ToDatabase()
    {
        var topic = Topic.Create("Title", "ShortDesc", "Req", "Reason", Guid.NewGuid());

        await _repository.AddAsync(topic, CancellationToken.None);
        await _context.SaveChangesAsync();

        var storedTopic = await _context.Topics.FirstOrDefaultAsync(t => t.Title == "Title");

        Assert.NotNull(storedTopic);
    }
}
```

---

### **‚úÖ `YourProject.API.Tests` (–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã API)**

**üõ† –ß—Ç–æ —Ç–µ—Å—Ç–∏—Ä—É–µ–º?**

- **–ö–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä—ã (—á–µ—Ä–µ–∑ `WebApplicationFactory`)**
- **–ó–∞–ø—Ä–æ—Å—ã –∏ –æ—Ç–≤–µ—Ç—ã API**
- **–¢–µ—Å—Ç–æ–≤–∞—è –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö**

**üìå –ü—Ä–∏–º–µ—Ä —Ç–µ—Å—Ç–∞ –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–∞ API:**

```csharp
public class TopicControllerTests : IClassFixture<WebApplicationFactory<Program>>
{
    private readonly HttpClient _client;

    public TopicControllerTests(WebApplicationFactory<Program> factory)
    {
        _client = factory.CreateClient();
    }

    [Fact]
    public async Task CreateManyTopics_ShouldReturnOk_WhenValidRequest()
    {
        var request = new CreateManyTopicsRequest(new[]
        {
            new CreateTopicRequest("Title", "ShortDesc", "Req", "Reason")
        });

        var jsonContent = new StringContent(JsonConvert.SerializeObject(request), Encoding.UTF8, "application/json");

        var response = await _client.PostAsync("/api/topics", jsonContent);

        response.EnsureSuccessStatusCode();
    }
}
```

---

### **‚úÖ `YourProject.EndToEnd.Tests` (E2E, UI, API, Selenium –∏ Postman-—Ç–µ—Å—Ç—ã)**

–≠—Ç–æ—Ç —É—Ä–æ–≤–µ–Ω—å —Ç–µ—Å—Ç–æ–≤ –Ω—É–∂–µ–Ω, –µ—Å–ª–∏ —Ç—ã —Ö–æ—á–µ—à—å –ø–æ–∫—Ä—ã—Ç—å **End-to-End —Å—Ü–µ–Ω–∞—Ä–∏–∏**, –∏–º–∏—Ç–∏—Ä—É—è **—Ä–µ–∞–ª—å–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è**.  
–ú–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å **Selenium, Playwright –∏–ª–∏ Postman/Newman**.

---

## **3Ô∏è‚É£ –ö–∞–∫ –¥–æ–±–∞–≤–∏—Ç—å —Ç–µ—Å—Ç–æ–≤—ã–µ –ø—Ä–æ–µ–∫—Ç—ã –≤ Solution?**

–°–æ–∑–¥–∞–π —Ç–µ—Å—Ç–æ–≤—ã–µ –ø—Ä–æ–µ–∫—Ç—ã –≤ `tests` –ø–∞–ø–∫–µ:

```sh
dotnet new xunit -n YourProject.Domain.Tests
dotnet new xunit -n YourProject.Application.Tests
dotnet new xunit -n YourProject.Infrastructure.Tests
dotnet new xunit -n YourProject.API.Tests
```

–ó–∞—Ç–µ–º –¥–æ–±–∞–≤—å —Å—Å—ã–ª–∫–∏ –Ω–∞ –Ω—É–∂–Ω—ã–µ –ø—Ä–æ–µ–∫—Ç—ã:

```sh
dotnet add YourProject.Domain.Tests reference ../src/YourProject.Domain
dotnet add YourProject.Application.Tests reference ../src/YourProject.Application
dotnet add YourProject.Application.Tests reference ../src/YourProject.Domain
dotnet add YourProject.Infrastructure.Tests reference ../src/YourProject.Infrastructure
dotnet add YourProject.Infrastructure.Tests reference ../src/YourProject.Domain
dotnet add YourProject.API.Tests reference ../src/YourProject.API
dotnet add YourProject.API.Tests reference ../src/YourProject.Application
dotnet add YourProject.API.Tests reference ../src/YourProject.Domain
```

---

## **4Ô∏è‚É£ –î–æ–±–∞–≤—å —Ç–µ—Å—Ç—ã –≤ CI/CD (GitHub Actions / GitLab CI/CD)**

### **GitHub Actions**

`.github/workflows/tests.yml`

```yaml
name: Run Tests
on: [push, pull_request]
jobs:
  test:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      - name: Setup .NET
        uses: actions/setup-dotnet@v3
        with:
          dotnet-version: '8.0.x'
      - name: Restore dependencies
        run: dotnet restore
      - name: Build
        run: dotnet build --no-restore
      - name: Run Tests
        run: dotnet test --no-build --verbosity normal
```

---

## **üî• –ò—Ç–æ–≥**

1Ô∏è‚É£ **–°–æ–∑–¥–∞–π –æ—Ç–¥–µ–ª—å–Ω—ã–µ –ø—Ä–æ–µ–∫—Ç—ã –≤ `tests/` –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Å–ª–æ—è**  
2Ô∏è‚É£ **–ú–æ–¥—É–ª—å–Ω—ã–µ —Ç–µ—Å—Ç—ã (`Domain`, `Application`)** ‚Üí –ø—Ä–æ–≤–µ—Ä—è—é—Ç –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫—É  
3Ô∏è‚É£ **–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã (`Infrastructure`, `API`)** ‚Üí —Ç–µ—Å—Ç–∏—Ä—É—é—Ç –ë–î, API  
4Ô∏è‚É£ **–î–æ–±–∞–≤—å `dotnet test` –≤ CI/CD**

üîπ **Best Practice** ‚Äî **–ø–æ–∫—Ä—ã–≤–∞—Ç—å –∫–æ–¥ —Ç–µ—Å—Ç–∞–º–∏ —Å —Ä–∞–∑–Ω–æ–π –≥–ª—É–±–∏–Ω–æ–π (Unit, Integration, API, E2E)**.  
‚ö° **–ù–∞—á–Ω–∏ —Å `Domain` –∏ `Application`, –∞ –∑–∞—Ç–µ–º —Ä–∞—Å—à–∏—Ä—è–π —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ!** üöÄ


# **–¢–µ—Å—Ç—ã –¥–æ–º–µ–Ω–Ω–æ–π –ª–æ–≥–∏–∫–∏**

–î–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω-—É—Ä–æ–≤–Ω—è –ø–æ–∫—Ä—ã—Ç–∏—è —Ç–µ—Å—Ç–∞–º–∏ –Ω—É–∂–Ω–æ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å **–æ—Å–Ω–æ–≤–Ω—ã–µ –±–∏–∑–Ω–µ—Å-–ø—Ä–∞–≤–∏–ª–∞** –∏ **–≥—Ä–∞–Ω–∏—á–Ω—ã–µ —Å–ª—É—á–∞–∏**.

### üîπ **1. –ö–∞—Ç–µ–≥–æ—Ä–∏–∏ —Ç–µ—Å—Ç–æ–≤**

- **–°–æ–∑–¥–∞–Ω–∏–µ —Ç–µ–º—ã (`Create`)**
- **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ —Å—Ç—É–¥–µ–Ω—Ç—É (`AssignToStudent`)**
- **–ò–∑–º–µ–Ω–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞ (`ChangeStatus`)**
- **–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö (`UpdateDetails`)**
- **–í–∞–ª–∏–¥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö (–≥—Ä–∞–Ω–∏—á–Ω—ã–µ —Å–ª—É—á–∞–∏)**

---

## **‚úÖ 2. –¢–µ—Å—Ç—ã, –∫–æ—Ç–æ—Ä—ã–µ –Ω—É–∂–Ω–æ –Ω–∞–ø–∏—Å–∞—Ç—å**

### **üìå 1. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ `Create`**

**–ü–æ–∑–∏—Ç–∏–≤–Ω—ã–µ –∫–µ–π—Å—ã:** ‚úî –¢–µ–º–∞ —Å–æ–∑–¥–∞—ë—Ç—Å—è —Å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏.  
‚úî –ü–æ–ª—è `CreatedAt` –∏ `UpdatedAt` —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—é—Ç—Å—è –≤ `DateTime.UtcNow` (—Å–º. [[#**–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –≤—Ä–µ–º–µ–Ω–∏**]]).  
‚úî `Reason` –ø—Ä–∞–≤–∏–ª—å–Ω–æ –ø–∞—Ä—Å–∏—Ç—Å—è, –µ—Å–ª–∏ –ø–µ—Ä–µ–¥–∞–Ω–æ –∑–Ω–∞—á–µ–Ω–∏–µ.  
‚úî `Reason` –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é ‚Äî `ProposedBySupervisor`, –µ—Å–ª–∏ `reason == null`.

**–ù–µ–≥–∞—Ç–∏–≤–Ω—ã–µ –∫–µ–π—Å—ã:**  
‚úî –û—à–∏–±–∫–∞, –µ—Å–ª–∏ `title == null` (–µ—Å–ª–∏ —Ç—ã —Ö–æ—á–µ—à—å –¥–æ–±–∞–≤–∏—Ç—å —Ç–∞–∫—É—é –ø—Ä–æ–≤–µ—Ä–∫—É).

---

### **üìå 2. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ `AssignToStudent`**

**–ü–æ–∑–∏—Ç–∏–≤–Ω—ã–µ –∫–µ–π—Å—ã:**  
‚úî –ú–æ–∂–Ω–æ –Ω–∞–∑–Ω–∞—á–∏—Ç—å —Å—Ç—É–¥–µ–Ω—Ç–∞, –µ—Å–ª–∏ —Å—Ç–∞—Ç—É—Å `Available`.  
‚úî `StudentId` —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è, `Status` –º–µ–Ω—è–µ—Ç—Å—è –Ω–∞ `Choosen`.  
‚úî `UpdatedAt` –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è.

**–ù–µ–≥–∞—Ç–∏–≤–Ω—ã–µ –∫–µ–π—Å—ã:**  
‚úî –ù–µ–ª—å–∑—è –Ω–∞–∑–Ω–∞—á–∏—Ç—å —Å—Ç—É–¥–µ–Ω—Ç–∞, –µ—Å–ª–∏ —Ç–µ–º–∞ **—É–∂–µ –≤—ã–±—Ä–∞–Ω–∞ (`Choosen`)**.

---

### **üìå 3. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ `ChangeStatus`**

‚úî –°—Ç–∞—Ç—É—Å –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –º–µ–Ω—è–µ—Ç—Å—è.  
‚úî `UpdatedAt` –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è.

---

### **üìå 4. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ `UpdateDetails`**

**–ü–æ–∑–∏—Ç–∏–≤–Ω—ã–µ –∫–µ–π—Å—ã:**  
‚úî –ï—Å–ª–∏ —Å—Ç–∞—Ç—É—Å `Available`, –æ–±–Ω–æ–≤–ª—è—é—Ç—Å—è `Title`, `ShortDescription`, `Requirements`.  
‚úî `UpdatedAt` –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è.

**–ù–µ–≥–∞—Ç–∏–≤–Ω—ã–µ –∫–µ–π—Å—ã:**  
‚úî –û—à–∏–±–∫–∞, –µ—Å–ª–∏ –ø—ã—Ç–∞–µ–º—Å—è –æ–±–Ω–æ–≤–∏—Ç—å —Ç–µ–º—É, –∫–æ—Ç–æ—Ä–∞—è —É–∂–µ –≤—ã–±—Ä–∞–Ω–∞ (`Choosen`).

---

## **‚úÖ 3. –ö–∞–∫ –ø–∏—Å–∞—Ç—å —Ç–µ—Å—Ç—ã?**

–ò—Å–ø–æ–ª—å–∑—É–π **xUnit + FluentAssertions**:

```csharp
public class TopicTests
{
    [Fact]
    public void Create_ShouldInitializeCorrectly()
    {
        // Arrange
        var title = "New Topic";
        var description = "Some description";
        var requirements = "Some requirements";
        var supervisorId = Guid.NewGuid();

        // Act
        var topic = Topic.Create(title, description, requirements, null, supervisorId);

        // Assert
        topic.Should().NotBeNull();
        topic.Title.Should().Be(title);
        topic.ShortDescription.Should().Be(description);
        topic.Requirements.Should().Be(requirements);
        topic.Status.Should().Be(TopicStatus.Available);
        topic.Reason.Should().Be(TopicReason.ProposedBySupervisor);
        topic.CreatedAt.Should().BeCloseTo(DateTime.UtcNow, TimeSpan.FromSeconds(1));
    }

    [Fact]
    public void AssignToStudent_ShouldUpdateStatus_WhenAvailable()
    {
        // Arrange
        var topic = Topic.Create("Title", "Desc", "Req", null, Guid.NewGuid());
        var studentId = Guid.NewGuid();

        // Act
        var result = topic.AssignToStudent(studentId);

        // Assert
        result.IsSuccess.Should().BeTrue();
        topic.StudentId.Should().Be(studentId);
        topic.Status.Should().Be(TopicStatus.Choosen);
    }

    [Fact]
    public void AssignToStudent_ShouldFail_WhenAlreadyChosen()
    {
        // Arrange
        var topic = Topic.Create("Title", "Desc", "Req", null, Guid.NewGuid());
        topic.AssignToStudent(Guid.NewGuid());

        // Act
        var result = topic.AssignToStudent(Guid.NewGuid());

        // Assert
        result.IsSuccess.Should().BeFalse();
        result.Error.Should().Be(Errors.Errors.Topic.AlreadyChoosen);
    }
}
```

---

## **‚úÖ 4. –ò—Ç–æ–≥**

**–ú–∏–Ω–∏–º–∞–ª—å–Ω–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ–µ –ø–æ–∫—Ä—ã—Ç–∏–µ** –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞ –≤–∫–ª—é—á–∞–µ—Ç:  
‚úî –ü—Ä–æ–≤–µ—Ä–∫—É **—Å–æ–∑–¥–∞–Ω–∏—è** –æ–±—ä–µ–∫—Ç–∞.  
‚úî –ü—Ä–æ–≤–µ—Ä–∫—É **–±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∏** (`AssignToStudent`, `ChangeStatus`, `UpdateDetails`).  
‚úî –ü—Ä–æ–≤–µ—Ä–∫—É **–æ—à–∏–±–æ—á–Ω—ã—Ö —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤** (–Ω–µ–ª—å–∑—è –Ω–∞–∑–Ω–∞—á–∏—Ç—å —Å—Ç—É–¥–µ–Ω—Ç–∞ –¥–≤–∞–∂–¥—ã, –Ω–µ–ª—å–∑—è –º–µ–Ω—è—Ç—å –¥–∞–Ω–Ω—ã–µ —É –≤—ã–±—Ä–∞–Ω–Ω–æ–π —Ç–µ–º—ã).

–° —ç—Ç–∏–º **–∫–æ–¥ –±—É–¥–µ—Ç –Ω–∞–¥—ë–∂–Ω—ã–º** –∏ **–ª–µ–≥–∫–æ —Ä–∞—Å—à–∏—Ä—è–µ–º—ã–º** üöÄ

### **–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –≤—Ä–µ–º–µ–Ω–∏**

–î–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏, —á—Ç–æ `CreatedAt` –∏ `UpdatedAt` —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—é—Ç—Å—è –≤ `DateTime.UtcNow`, –Ω—É–∂–Ω–æ —É—á–∏—Ç—ã–≤–∞—Ç—å, —á—Ç–æ `DateTime.UtcNow` –º–µ–Ω—è–µ—Ç—Å—è —Å —Ç–µ—á–µ–Ω–∏–µ–º –≤—Ä–µ–º–µ–Ω–∏. –ß—Ç–æ–±—ã –∏–∑–±–µ–∂–∞—Ç—å —Ñ–ª–∞–∫–∏-—Ç–µ—Å—Ç–æ–≤, –º–æ–∂–Ω–æ —Å—Ä–∞–≤–Ω–∏–≤–∞—Ç—å –≤—Ä–µ–º—è —Å –¥–æ–ø—É—Å—Ç–∏–º–æ–π –ø–æ–≥—Ä–µ—à–Ω–æ—Å—Ç—å—é –≤ –Ω–µ—Å–∫–æ–ª—å–∫–æ —Å–µ–∫—É–Ω–¥.

---

### ‚úÖ **–°–ø–æ—Å–æ–± 1: FluentAssertions (`BeCloseTo`)**

**–≠—Ç–æ—Ç –º–µ—Ç–æ–¥ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç, —á—Ç–æ –∑–Ω–∞—á–µ–Ω–∏–µ –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ –¥–∏–∞–ø–∞–∑–æ–Ω–µ `DateTime.UtcNow ¬± X —Å–µ–∫—É–Ω–¥`**.

```csharp
[Fact]
public void Create_ShouldInitialize_CreatedAt_And_UpdatedAt_Correctly()
{
    // Arrange
    var title = "New Topic";
    var description = "Some description";
    var requirements = "Some requirements";
    var supervisorId = Guid.NewGuid();
    var beforeCreation = DateTime.UtcNow;

    // Act
    var topic = Topic.Create(title, description, requirements, null, supervisorId);
    var afterCreation = DateTime.UtcNow;

    // Assert
    topic.CreatedAt.Should().BeCloseTo(beforeCreation, TimeSpan.FromSeconds(1));
    topic.UpdatedAt.Should().BeCloseTo(beforeCreation, TimeSpan.FromSeconds(1));
}
```

**–û–±—ä—è—Å–Ω–µ–Ω–∏–µ:**

- –ú—ã —Å–æ—Ö—Ä–∞–Ω—è–µ–º `beforeCreation = DateTime.UtcNow` **–¥–æ —Å–æ–∑–¥–∞–Ω–∏—è –æ–±—ä–µ–∫—Ç–∞**.
- –°–æ–∑–¥–∞—ë–º –æ–±—ä–µ–∫—Ç `topic`.
- –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ `CreatedAt` –∏ `UpdatedAt` –Ω–∞—Ö–æ–¥—è—Ç—Å—è –≤ –ø—Ä–µ–¥–µ–ª–∞—Ö **¬±1 —Å–µ–∫—É–Ω–¥—ã** –æ—Ç `beforeCreation`.

üìå **`BeCloseTo()`** ‚Äî –æ—Ç–ª–∏—á–Ω—ã–π –º–µ—Ç–æ–¥ –¥–ª—è —Ç–∞–∫–∏—Ö –ø—Ä–æ–≤–µ—Ä–æ–∫, –ø–æ—Ç–æ–º—É —á—Ç–æ –æ–Ω –ø–æ–∑–≤–æ–ª—è–µ—Ç –Ω–µ–±–æ–ª—å—à—É—é —Ä–∞–∑–Ω–∏—Ü—É –∏–∑-–∑–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∫–æ–¥–∞.

---

### ‚úÖ **–°–ø–æ—Å–æ–± 2: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Mock –¥–ª—è `DateTime.UtcNow`**

–ï—Å–ª–∏ —Ö–æ—á–µ—à—å **–∂—ë—Å—Ç–∫–æ –∑–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞—Ç—å –≤—Ä–µ–º—è** –≤ —Ç–µ—Å—Ç–∞—Ö, –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `DateTimeProvider`.

#### **1. –í—ã–Ω–µ—Å—Ç–∏ `DateTime.UtcNow` –≤ —Å–µ—Ä–≤–∏—Å**

```csharp
public interface IDateTimeProvider
{
    DateTime UtcNow { get; }
}

public class SystemDateTimeProvider : IDateTimeProvider
{
    public DateTime UtcNow => DateTime.UtcNow;
}
```

–ó–∞—Ç–µ–º **–∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≤ `Topic`**:

```csharp
public class Topic
{
    private readonly IDateTimeProvider _dateTimeProvider;

    private Topic(string title, IDateTimeProvider dateTimeProvider)
    {
        _dateTimeProvider = dateTimeProvider;
        CreatedAt = _dateTimeProvider.UtcNow;
        UpdatedAt = _dateTimeProvider.UtcNow;
    }
}
```

#### **2. –í —Ç–µ—Å—Ç–∞—Ö –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `Mock<IDateTimeProvider>`**

```csharp
[Fact]
public void Create_ShouldSet_CreatedAt_And_UpdatedAt()
{
    // Arrange
    var fixedTime = new DateTime(2025, 03, 18, 12, 00, 00, DateTimeKind.Utc);
    var dateTimeMock = new Mock<IDateTimeProvider>();
    dateTimeMock.Setup(d => d.UtcNow).Returns(fixedTime);

    // Act
    var topic = Topic.Create("Title", "Desc", "Req", null, Guid.NewGuid(), dateTimeMock.Object);

    // Assert
    topic.CreatedAt.Should().Be(fixedTime);
    topic.UpdatedAt.Should().Be(fixedTime);
}
```

**–ü–ª—é—Å—ã:**

- –ü–æ–∑–≤–æ–ª—è–µ—Ç **–∂—ë—Å—Ç–∫–æ –∑–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞—Ç—å –≤—Ä–µ–º—è**, —É–±–∏—Ä–∞—è –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å —Ñ–ª–∞–∫–∏-—Ç–µ—Å—Ç–æ–≤.
- –•–æ—Ä–æ—à–∏–π –≤–∞—Ä–∏–∞–Ω—Ç, –µ—Å–ª–∏ —Ç—ã **–∞–∫—Ç–∏–≤–Ω–æ –∏—Å–ø–æ–ª—å–∑—É–µ—à—å `DateTime.UtcNow` –≤ –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–µ**.

---

### üöÄ **–í—ã–≤–æ–¥**

- **–ü—Ä–æ—Å—Ç–æ–π –≤–∞—Ä–∏–∞–Ω—Ç**: `BeCloseTo(beforeCreation, TimeSpan.FromSeconds(1))`.
- **–ë–æ–ª–µ–µ –Ω–∞–¥—ë–∂–Ω—ã–π –≤–∞—Ä–∏–∞–Ω—Ç** (–µ—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—à—å `DateTime.UtcNow` –≤–æ –º–Ω–æ–≥–∏—Ö –º–µ—Å—Ç–∞—Ö): **Mock `DateTimeProvider`**.

–ï—Å–ª–∏ —Ç–µ–±–µ –Ω–µ –Ω—É–∂–Ω–∞ 100% —Ñ–∏–∫—Å–∞—Ü–∏—è –≤—Ä–µ–º–µ–Ω–∏ –≤ —Ç–µ—Å—Ç–∞—Ö, **–ø–µ—Ä–≤—ã–π –≤–∞—Ä–∏–∞–Ω—Ç —Å `BeCloseTo()` ‚Äî –æ–ø—Ç–∏–º–∞–ª—å–Ω—ã–π**. üöÄ

# **–ü—Ä–∏–º–µ—Ä —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –í–ò "–°–æ–∑–¥–∞—Ç—å —Ç–µ–º—É –ö–ü"**

–í –¥–∞–Ω–Ω–æ–º —Ö–µ–Ω–¥–ª–µ—Ä–µ –µ—Å—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ –≤–∞–∂–Ω—ã—Ö –∞—Å–ø–µ–∫—Ç–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å. –û—Å–Ω–æ–≤–Ω—ã–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏, –∫–æ—Ç–æ—Ä—ã–µ –Ω—É–∂–Ω–æ –ø–æ–∫—Ä—ã—Ç—å —Ç–µ—Å—Ç–∞–º–∏:

### 3. **–°–æ–∑–¥–∞–Ω–∏–µ —Ç–æ–ø–∏–∫–∞:**

- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ —Ö–µ–Ω–¥–ª–µ—Ä –≤—ã–∑—ã–≤–∞–µ—Ç –º–µ—Ç–æ–¥ `CreateTopic` —É —Å–µ—Ä–≤–∏—Å–∞ `ITopicService`.
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ —Å–æ–∑–¥–∞–µ—Ç—Å—è –æ–±—ä–µ–∫—Ç `Topic` —Å –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–º–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏.

### 4. **–û–±—Ä–∞–±–æ—Ç–∫–∞ —É—Å–ø–µ—à–Ω–æ–≥–æ –∏ –Ω–µ—É—Å–ø–µ—à–Ω–æ–≥–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞:**

- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ –º–µ—Ç–æ–¥ `Handle` –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç `Result.Success()`, –µ—Å–ª–∏ —Å–æ–∑–¥–∞–Ω–∏–µ —Ç–æ–ø–∏–∫–∞ –ø—Ä–æ—à–ª–æ —É—Å–ø–µ—à–Ω–æ.
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ –º–µ—Ç–æ–¥ `Handle` –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç `Result.Failure()`, –µ—Å–ª–∏ —Å–æ–∑–¥–∞–Ω–∏–µ —Ç–æ–ø–∏–∫–∞ –Ω–µ —É–¥–∞–ª–æ—Å—å (–Ω–∞–ø—Ä–∏–º–µ—Ä, –µ—Å–ª–∏ —Å–µ—Ä–≤–∏—Å –≤–µ—Ä–Ω—É–ª –æ—à–∏–±–∫—É).

### –ü—Ä–∏–º–µ—Ä —Ç–µ—Å—Ç–æ–≤:

1. **–¢–µ—Å—Ç –Ω–∞ –≤—ã–∑–æ–≤ –º–µ—Ç–æ–¥–∞ `CreateTopic` —É —Å–µ—Ä–≤–∏—Å–∞:**
    
    ```csharp
    [Fact]
    public async Task Handle_ShouldCallCreateTopicService_WhenCalled()
    {
        // Arrange
        var mockLogger = new Mock<ILogger<CreateTopicCommandHandler>>();
        var mockTopicService = new Mock<ITopicService>();
        var command = new CreateTopicCommand("Title", "ShortDescription", "Requirements", "ProposedBySupervisor", Guid.NewGuid().ToString());
        var handler = new CreateTopicCommandHandler(mockTopicService.Object, mockLogger.Object);
    
        mockTopicService.Setup(service => service.CreateTopic(It.IsAny<Topic>(), It.IsAny<string>(), It.IsAny<CancellationToken>()))
            .ReturnsAsync(Result.Success());
    
        // Act
        await handler.Handle(command, CancellationToken.None);
    
        // Assert
        mockTopicService.Verify(service => service.CreateTopic(It.IsAny<Topic>(), It.IsAny<string>(), It.IsAny<CancellationToken>()), Times.Once);
    }
    ```
    
2. **–¢–µ—Å—Ç –Ω–∞ –≤–æ–∑–≤—Ä–∞—â–µ–Ω–∏–µ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞:**
    
    ```csharp
    [Fact]
    public async Task Handle_ShouldReturnSuccess_WhenTopicCreatedSuccessfully()
    {
        // Arrange
        var mockLogger = new Mock<ILogger<CreateTopicCommandHandler>>();
        var mockTopicService = new Mock<ITopicService>();
        var command = new CreateTopicCommand("Title", "ShortDescription", "Requirements", "ProposedBySupervisor", Guid.NewGuid().ToString());
        var handler = new CreateTopicCommandHandler(mockTopicService.Object, mockLogger.Object);
    
        mockTopicService.Setup(service => service.CreateTopic(It.IsAny<Topic>(), It.IsAny<string>(), It.IsAny<CancellationToken>()))
            .ReturnsAsync(Result.Success());
    
        // Act
        var result = await handler.Handle(command, CancellationToken.None);
    
        // Assert
        result.Should().Be(Result.Success());
    }
    
    [Fact]
    public async Task Handle_ShouldReturnFailure_WhenTopicCreationFails()
    {
        // Arrange
        var mockLogger = new Mock<ILogger<CreateTopicCommandHandler>>();
        var mockTopicService = new Mock<ITopicService>>();
        var command = new CreateTopicCommand("Title", "ShortDescription", "Requirements", "ProposedBySupervisor", Guid.NewGuid().ToString());
        var handler = new CreateTopicCommandHandler(mockTopicService.Object, mockLogger.Object);
    
        mockTopicService.Setup(service => service.CreateTopic(It.IsAny<Topic>(), It.IsAny<string>(), It.IsAny<CancellationToken>()))
            .ReturnsAsync(Result.Failure(Errors.Topic.NotCreated));
    
        // Act
        var result = await handler.Handle(command, CancellationToken.None);
    
        // Assert
        result.Should().Be(Result.Failure(Errors.Topic.NotCreated));
    }
    ```
    

### –í–∞–∂–Ω—ã–µ –º–æ–º–µ–Ω—Ç—ã:

- **–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ:** –ü—Ä–æ–≤–µ—Ä—è–π—Ç–µ, —á—Ç–æ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –Ω–∞ –∫–∞–∂–¥–æ–º –≤–∞–∂–Ω–æ–º —ç—Ç–∞–ø–µ (–ø–æ–ª—É—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö, —É—Å–ø–µ—à–Ω–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ, –æ—à–∏–±–∫–∏).
- **–°–æ–∑–¥–∞–Ω–∏–µ —Ç–æ–ø–∏–∫–∞:** –ü—Ä–æ–≤–µ—Ä—è–π—Ç–µ, —á—Ç–æ –æ–±—ä–µ–∫—Ç `Topic` —Å–æ–∑–¥–∞–µ—Ç—Å—è —Å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏, –∏ —á—Ç–æ –º–µ—Ç–æ–¥ `CreateTopic` –≤ —Å–µ—Ä–≤–∏—Å–µ –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è.
- **–û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫:** –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —Ö–µ–Ω–¥–ª–µ—Ä –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –æ—à–∏–±–∫—É –∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç `Result.Failure` –≤ —Å–ª—É—á–∞–µ –Ω–µ—É–¥–∞—á–∏.