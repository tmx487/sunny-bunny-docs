Конфликт — это не ошибка, а особенность командной работы. Процесс не стоит на месте, и проекты постоянно развиваются: в них появляются новые функциональности или дорабатываются старые. Так что угнаться за изменениями бывает непросто.

В этом уроке рассмотрим одну из таких типичных рабочих ситуаций, которые могут привести к конфликту в Git.

### Основная ветка «убежала» во время ревью

Представьте: вы создаёте пул-реквест, чтобы добавить свои изменения из ветки `feature/my-new-awesome-code` в основную ветку `main`. Схематически это выглядит так.

![](https://pictures.s3.yandex.net/resources/M4_T4_01201_1689627422.png)

В вашей команде все изменения должны проходить ревью, поэтому вам нужно подождать, пока один из коллег одобрит ваш пул-реквест.

В это время в `main` вливается ветка другого коллеги (`feature/other-colleague-code`), которая попала на ревью раньше вашей, и передвигает `main` вперёд. Теперь на GitHub новая версия репозитория. А локально у вас всё ещё старая.

![](https://pictures.s3.yandex.net/resources/M4_T4_02201_1689627442.png)

Теперь ваши изменения отстают от ветки `main`. Дальше может быть два варианта развития событий.

Первый: ваши изменения и текущие изменения в `main` получится «смёржить» автоматически, потому что GitHub сможет самостоятельно разрешить конфликт. В этом случае кнопка **Merge pull request** в интерфейсе пул-реквеста всё ещё будет зелёной.

![](https://pictures.s3.yandex.net/resources/M4_T4_03-3_1689627458.png)

Второй: два изменения не могут существовать вместе, и вы увидите следующее предупреждение.

![](https://pictures.s3.yandex.net/resources/M4_T4_04-2_1689627475.png)

Хотя GitHub предоставляет интерфейс для разрешения конфликтов, обычно это делается локально. На своём локальном компьютере вы можете использовать более удобные инструменты для разрешения конфликтов, такие как Visual Studio Code.

Разрешить конфликт можно так:

1. Перейти в ветку `main`.
2. Загрузить новые изменения из неё с помощью `git pull`. При этом вы также загрузите ветку вашего коллеги.
3. Снова перейти в вашу ветку `feature/my-new-awesome-code`.
4. Выполнить `git merge main` и разрешить конфликт локально. В результате будет создан локальный коммит слияния.

![](https://pictures.s3.yandex.net/resources/M4_T4_05-3_1689675483.png)

5. Отправить изменения из вашей ветки в репозиторий с помощью `git push`. Так коммит слияния попадёт в удалённый репозиторий и в пул-реквест.

Теперь, когда ваши изменения пройдут ревью и окажутся в `main`, удалённый и локальный репозитории будут выглядеть так.

![](https://pictures.s3.yandex.net/resources/M4_T4_06-2_1689627557.png)

- В командной работе регулярно случаются конфликты — и в этом нет ничего страшного.
- Чтобы разрешить конфликт слияния, который возникает, когда главная ветка «уходит» вперёд, можно сделать следующее. Сначала локально получить новые изменения через `git pull`, а затем выполнить `git merge` и разрешить конфликт. Далее создать коммит слияния и отправить новые изменения без конфликтов обратно в удалённый репозиторий командой `git push`.
