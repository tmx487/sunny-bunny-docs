---
уровень: "[[junior]]"
секция: базы_данных
пройдено: 
теги: 
дата: 02-05-2024
время: 20:13
---
> [Habr: Как устроено индексирование баз данных](#https://habr.com/ru/companies/ruvds/articles/724066/)

Конкретный процесс создания индекса может варьироваться в зависимости от типа используемой системы базы данных, однако в целом общие этапы выглядят так:  
1. Определение столбца или столбцов в таблице базы данных, которые нужно индексировать. Обычно они определяются по тому, какие столбцы чаще всего используются в запросах или поисках.
2. Выбор алгоритма индексирования, подходящего для типа индексируемых данных. Например, индексы в виде B-деревьев обычно используются для индексирования строковых или числовых данных, а полнотекстовые индексы — для индексирования текстовых данных.
3. Применение алгоритма индексирования к выбранным столбцам, что создаёт структуру данных, сопоставляющую значения в столбцах с местоположениями соответствующих записей таблицы.
4. Сохранение индекса в отдельной структуре данных, обычно в другой части диска или в памяти, чтобы доступ к ней был более эффективным, чем к соответствующим табличным данным.
5. Обновление индекса в случае добавления новых записей, удаления или изменения записей в таблице.
   
> **Одними из ярких минусов индексирования являются увеличение требований к объему хранилища, снижение скорости выполнения операций вставки и удаления записей.**
   
   Наиболее популярными алгоритмами индексирования являются:
   - **B-tree** (быстро происходит вставка, поиск, удаление)
	   ***B-дерево***- это структура данных самобалансирующегося дерева, которая часто используется в качестве алгоритма индексирования в базах данных. Каждый узел дерева состоит из набора ключей и указателей на дочерние узлы; хранение данных осуществляется в иерархической структуре. Деревья B-узлов упорядочены таким образом, что позволяют быстро выполнять поиск, вставку и удаление данных.
   - **bitmap-index** (
     - быстро происходит чтение;
     - используется для сокращения время ответа для больших классов и запросов;
     - примеры: git, jpg, png, etc. )
	***Bitmap-индексирование*** — это методика индексирования данных, использующая битовые карты (bitmap) для обозначения наличия или отсутствия значения в таблице. Это успешная техника индексирования для таблиц с низкой кардинальностью, где количество уникальных значений в столбце довольно мало по сравнению с общим количеством строк.

   - **hash-index**
   
	   Хэш-индекс - это разновидность методики индексирования баз данных, использующая хэш-функцию для сопоставления ключей индекса с местоположениями соответствующих записей данных. Это быстрый метод индексирования для запросов точного соответствия в одном столбце.  Сопоставление ключей индекса с местоположениями соответствующих записей данных позволяет выполнять быстрый поиск и вставки за постоянное время O(1). Однако этот метод плохо работает с запросами диапазонов или частичными совпадениями и может страдать от коллизий, с которыми можно справляться при помощи различных техник разрешения коллизий.

   - **GiST (generalised search tree)** -- это техника индексирования баз данных, которая может использоваться для индексирования сложных типов данных, например, ***геометрических объектов, текста или массивов***. Это сбалансированная древовидная структура, состоящая из узлов с множественными дочерними узлами. Каждый узел описывает диапазон или множество значений и связан с предикативной функцией, проверяющей, принадлежит ли значение диапазону или множеству. Предикативная функция зависит от типа индексируемых данных и может быть подстроена под разные типы данных.  
   
	   ==низкая скорость операций вставки и обновления; подходит не для всех типов данных
   
   - **fulltext-index** (полнотекстовое индексирование) — это методика индексирования баз данных, используемая для повышения эффективности поиска текстовых запросов. Это особый вид индекса, спроектированный для работы с текстовыми данными. В отличие от традиционных индексов, хранящих значения отдельных столбцов, полнотекстовый индекс хранит текстовое содержимое одного или нескольких столбцов как множества слов или токенов. Эти слова или токены используются при выполнении поискового запроса для быстрого нахождения релевантных строк.

> Индексы позволяют ускорить поиск по полю или набору полей, а также обеспечивают уникальность данных.

**Кластеризованный индекс** - индекс на основе первичного ключа (строки физически сортируются на диске в соответствии с индексируемым полем в определенном порядке: по возрастанию или по убыванию). Таблица или представление могут иметь **только один** кластеризованный индекс.

**Некластеризованный индекс** - индекс на основе одного или нескольких не ключевых столбцов (хранится отдельно от таблицы, для которой определен); строки в таблице могут находится в любом порядке, а сортировка осуществляется при помощи специальной таблицы - дерева индексов. Некластеризованный индекс хранит в себе информацию о ключевых столбцах, для которых был создан индекс, а также ссылки на строки исходной таблицы, где хранятся данные. Максимальное количество столбцов, из которых может состоять некластеризованный индекс, зависит от СУБД, но обычно это 16.

> Для первичных ключей и столбцов, отмеченных как UNIQUE, кластеризованные индексы создаются автоматически - НЕВЕРНО, т.к. это зависит от конкретной СУБД.

Лучше не использовать индексы в следующих случаях:
- в небольших таблицах;
- в таблицах с частыми массовыми update и insert;
- для столбцов, содержащих большое количество значений NULL;
- для столбцов, которые часто обрабатываются.