---
уровень: "[[middle]]"
секция: типы, структуры и коллекции данных
пройдено: 
теги: 
дата: 02-05-2024
время: 20:31
---
В C# индексатор — это специальный тип свойства, который позволяет объекту класса или структуры индексироваться так же, как массив. Это упрощает доступ к элементам объекта, предоставляя синтаксис, аналогичный обращению к элементам массива, но при этом предоставляя возможность контролировать доступ к этим элементам через методы класса или структуры.

### Основные особенности индексатора

1. **Синтаксис**:
   Индексатор объявляется внутри класса или структуры с использованием ключевого слова `this` и параметров, которые могут быть использованы для доступа к элементам объекта. Он работает аналогично свойству, но используется для доступа к элементам по индексу.

2. **Пример использования**:
   Рассмотрим пример простого индексатора в классе:

   ```csharp
   public class MyCollection
   {
       private string[] items = new string[10];

       // Индексатор для доступа к элементам массива
       public string this[int index]
       {
           get
           {
               // Проверка границ индекса
               if (index < 0 || index >= items.Length)
                   throw new IndexOutOfRangeException("Index out of range");
               return items[index];
           }
           set
           {
               // Проверка границ индекса
               if (index < 0 || index >= items.Length)
                   throw new IndexOutOfRangeException("Index out of range");
               items[index] = value;
           }
       }
   }
   ```

   В этом примере индексатор позволяет обращаться к элементам массива `items` класса `MyCollection` как к элементам массива, используя синтаксис `object[index]`. 

   ```csharp
   MyCollection collection = new MyCollection();
   collection[0] = "Hello"; // Установка значения
   string value = collection[0]; // Получение значения
   ```

3. **Множественные параметры**:
   Индексаторы могут использовать несколько параметров:

   ```csharp
   public class Matrix
   {
       private int[,] data = new int[10, 10];

       // Индексатор с двумя параметрами
       public int this[int row, int col]
       {
           get
           {
               return data[row, col];
           }
           set
           {
               data[row, col] = value;
           }
       }
   }
   ```

   В этом примере индексатор позволяет доступ к элементам двумерного массива `data` с использованием двух индексов.

4. **Чтение и запись**:
   Индексаторы могут быть только для чтения, только для записи или для обоих операций (чтение и запись), в зависимости от того, как они объявлены.

   ```csharp
   // Индексатор только для чтения
   public string this[int index] => items[index];
   ```

   ```csharp
   // Индексатор только для записи
   public string this[int index]
   {
       set
       {
           items[index] = value;
       }
   }
   ```

5. **Применение**:
   Индексаторы полезны, когда необходимо создать объект, который представляет собой коллекцию элементов, где доступ к элементам осуществляется по индексу. Они могут быть полезны в пользовательских коллекциях, матрицах, таблицах и других структурах данных.

### Примеры использования:

**Пример с пользовательской коллекцией**:

```csharp
public class StringList
{
    private List<string> items = new List<string>();

    // Индексатор для доступа к строкам
    public string this[int index]
    {
        get
        {
            if (index < 0 || index >= items.Count)
                throw new IndexOutOfRangeException("Index out of range");
            return items[index];
        }
        set
        {
            if (index < 0 || index >= items.Count)
                throw new IndexOutOfRangeException("Index out of range");
            items[index] = value;
        }
    }

    public void Add(string item)
    {
        items.Add(item);
    }
}

class Program
{
    static void Main()
    {
        StringList list = new StringList();
        list.Add("One");
        list.Add("Two");

        // Использование индексатора
        Console.WriteLine(list[0]); // Output: One
        list[1] = "Changed";
        Console.WriteLine(list[1]); // Output: Changed
    }
}
```

Индексаторы предоставляют гибкость в реализации доступа к данным и могут значительно упростить синтаксис кода, улучшая читаемость и удобство работы с пользовательскими типами данных.