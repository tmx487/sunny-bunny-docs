---
уровень: "[[middle]]"
секция: общее
пройдено: 
теги: 
дата: 02-05-2024
время: 20:22
---
Паттерн Strategy (Стратегия) является поведенческим шаблоном проектирования, который позволяет выбрать алгоритм поведения объекта во время выполнения программы. Он определяет семейство алгоритмов, инкапсулирует каждый из них и делает их взаимозаменяемыми. Стратегия позволяет изменять алгоритмы независимо от клиентов, которые их используют.

### Основные идеи паттерна Strategy:

1. **Инкапсуляция алгоритмов:**
   - Разные алгоритмы поведения инкапсулируются в отдельные классы, которые реализуют общий интерфейс.
   
2. **Взаимозаменяемость:**
   - Классы, реализующие интерфейс стратегии, могут заменяться друг другом во время выполнения программы без изменения клиентского кода.
   
3. **Поддержка принципа открытости/закрытости:**
   - Паттерн позволяет добавлять новые алгоритмы без изменения существующих классов, что делает систему более гибкой и расширяемой.

### Когда использовать паттерн Strategy:

- Когда у вас есть несколько схожих классов, отличающихся только поведением.
- Когда необходимо выбрать алгоритм или поведение во время выполнения программы.
- Когда нужно избежать множества условных операторов (if-else, switch-case), определяющих поведение программы.

### Пример использования паттерна Strategy:

Рассмотрим пример, в котором у нас есть различные алгоритмы расчета стоимости доставки товаров.

```csharp
// Интерфейс стратегии
public interface IShippingStrategy
{
    decimal CalculateShippingCost(Order order);
}

// Конкретные стратегии
public class RegularShippingStrategy : IShippingStrategy
{
    public decimal CalculateShippingCost(Order order)
    {
        return 10.0m;
    }
}

public class ExpressShippingStrategy : IShippingStrategy
{
    public decimal CalculateShippingCost(Order order)
    {
        return 20.0m;
    }
}

// Контекст, использующий стратегию
public class Order
{
    public IShippingStrategy ShippingStrategy { get; set; }
    public decimal CalculateShippingCost()
    {
        return ShippingStrategy.CalculateShippingCost(this);
    }
}

// Пример использования
public class Program
{
    public static void Main(string[] args)
    {
        Order order = new Order();

        // Используем обычную доставку
        order.ShippingStrategy = new RegularShippingStrategy();
        Console.WriteLine($"Regular Shipping Cost: {order.CalculateShippingCost()}");

        // Меняем стратегию на экспресс-доставку
        order.ShippingStrategy = new ExpressShippingStrategy();
        Console.WriteLine($"Express Shipping Cost: {order.CalculateShippingCost()}");
    }
}
```

### Разбор кода:

1. **Интерфейс стратегии:**
   - `IShippingStrategy` определяет метод `CalculateShippingCost`, который должен быть реализован всеми конкретными стратегиями.

2. **Конкретные стратегии:**
   - `RegularShippingStrategy` и `ExpressShippingStrategy` реализуют метод `CalculateShippingCost` по-своему.

3. **Контекст:**
   - Класс `Order` содержит ссылку на интерфейс стратегии и метод `CalculateShippingCost`, который делегирует расчет стоимости доставки выбранной стратегии.

4. **Использование:**
   - В примере показано, как можно переключаться между различными стратегиями доставки во время выполнения программы.

### Вывод:

Паттерн Strategy предоставляет гибкий способ выбора алгоритмов поведения во время выполнения программы. Он позволяет легко добавлять новые алгоритмы и изменять существующие без необходимости модифицировать клиентский код. Этот паттерн улучшает модульность, читаемость и поддержку кода.